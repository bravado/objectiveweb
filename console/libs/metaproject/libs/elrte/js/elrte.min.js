function eli18n(a){this.textdomain=function(b){return this.messages[b]?this._domain=b:this._domain};a&&a.messages&&this.load(a.messages);a&&a.textdomain&&this.textdomain(a.textdomain)}eli18n.prototype=new function(){this.messages={};this._domain="";this.load=function(c){if(typeof(c)=="object"){for(var a in c){var b=c[a];if(typeof(b)=="object"){if(!this.messages[a]){this.messages[a]={}}for(var f in b){if(typeof(b[f])=="string"){this.messages[a][f]=b[f]}}}}}return this};this.translate=function(b,a){var a=a&&this.messages[a]?a:this._domain;
return this.messages[a]&&this.messages[a][b]?this.messages[a][b]:b};this.format=function(f,b,a){f=this.translate(f,a);if(typeof(b)=="object"){for(var c in b){f=f.replace("%"+c,this.translate(b[c],a))}}return f}};function elDialogForm(c){var a=this;var b={"class":"el-dialogform",submit:function(g,f){f.close()},form:{action:window.location.href,method:"post"},ajaxForm:null,validate:null,spinner:"Loading",tabs:{active:0,selected:0},tabPrefix:"el-df-tab-",dialog:{title:"dialog",autoOpen:false,modal:true,resizable:false,closeOnEscape:true,buttons:{Cancel:function(){a.close()
},Ok:function(){a.form.trigger("submit")}}}};this.opts=jQuery.extend(true,{},b,c);this.opts.dialog.close=function(){a.close()};if(this.opts.rtl){this.opts["class"]+=" el-dialogform-rtl"}if(c&&c.dialog&&c.dialog.buttons&&typeof(c.dialog.buttons)=="object"){this.opts.dialog.buttons=c.dialog.buttons}this.ul=null;this.tabs={};this._table=null;this.dialog=jQuery("<div />").addClass(this.opts["class"]).dialog(this.opts.dialog);this.message=jQuery('<div class="el-dialogform-message rounded-5" />').hide().appendTo(this.dialog);
this.error=jQuery('<div class="el-dialogform-error rounded-5" />').hide().appendTo(this.dialog);this.spinner=jQuery('<div class="spinner" />').hide().appendTo(this.dialog);this.content=jQuery('<div class="el-dialogform-content" />').appendTo(this.dialog);this.form=jQuery("<form />").attr(this.opts.form).appendTo(this.content);if(this.opts.submit){this.form.bind("submit",function(f){a.opts.submit(f,a)})}if(this.opts.ajaxForm&&jQuery.fn.ajaxForm){this.form.ajaxForm(this.opts.ajaxForm)}if(this.opts.validate){this.form.validate(this.opts.validate)
}this.option=function(f,g){return this.dialog.dialog("option",f,g)};this.showError=function(g,f){this.hideMessage();this.hideSpinner();this.error.html(g).show();f&&this.content.hide();return this};this.hideError=function(){this.error.text("").hide();this.content.show();return this};this.showSpinner=function(f){this.error.hide();this.message.hide();this.content.hide();this.spinner.text(f||this.opts.spinner).show();this.option("buttons",{});return this};this.hideSpinner=function(){this.content.show();
this.spinner.hide();return this};this.showMessage=function(f,g){this.hideError();this.hideSpinner();this.message.html(f||"").show();g&&this.content.hide();return this};this.hideMessage=function(){this.message.hide();this.content.show();return this};this.tab=function(f,g){f=this.opts.tabPrefix+f;if(!this.ul){this.ul=jQuery("<ul />").prependTo(this.form)}jQuery("<li />").append(jQuery("<a />").attr("href","#"+f).html(g)).appendTo(this.ul);this.tabs[f]={tab:jQuery("<div />").attr("id",f).addClass("tab").appendTo(this.form),table:null};
return this};this.table=function(f){f=f&&f.indexOf(this.opts.tabPrefix)==-1?this.opts.tabPrefix+f:f;if(f&&this.tabs&&this.tabs[f]){this.tabs[f].table=jQuery("<table />").appendTo(this.tabs[f].tab)}else{this._table=jQuery("<table />").appendTo(this.form)}return this};this.append=function(f,k,g){k=k?"el-df-tab-"+k:"";if(!f){return this}if(k&&this.tabs[k]){if(g){!this.tabs[k].table&&this.table(k);var j=jQuery("<tr />").appendTo(this.tabs[k].table);if(!jQuery.isArray(f)){j.append(jQuery("<td />").append(f))
}else{for(var h=0;h<f.length;h++){j.append(jQuery("<td />").append(f[h]))}}}else{if(!jQuery.isArray(f)){this.tabs[k].tab.append(f)}else{for(var h=0;h<f.length;h++){this.tabs[k].tab.append(f[h])}}}}else{if(!g){if(!jQuery.isArray(f)){this.form.append(f)}else{for(var h=0;h<f.length;h++){this.form.append(f[h])}}}else{if(!this._table){this.table()}var j=jQuery("<tr />").appendTo(this._table);if(!jQuery.isArray(f)){j.append(jQuery("<td />").append(f))}else{for(var h=0;h<f.length;h++){j.append(jQuery("<td />").append(f[h]))
}}}}return this};this.separator=function(f){f="el-df-tab-"+f;if(this.tabs&&this.tabs[f]){this.tabs[f].tab.append(jQuery("<div />").addClass("separator"));this.tabs[f].table&&this.table(f)}else{this.form.append(jQuery("<div />").addClass("separator"))}return this};this.open=function(){var f=this;this.ul&&this.form.tabs(this.opts.tabs);setTimeout(function(){f.dialog.find(":text").keydown(function(g){if(g.keyCode==13){g.preventDefault();f.form.submit()}}).first().focus()},200);this.dialog.dialog("open");
return this};this.close=function(){if(typeof(this.opts.close)=="function"){this.opts.close()}this.dialog.dialog("destroy")}}(function(a){a.fn.elColorPicker=function(h){var c=this;var g=a.extend({},a.fn.elColorPicker.defaults,h);this.hidden=a('<input type="hidden" />').attr("name",g.name).val(g.color||"").appendTo(this);this.palette=null;this.preview=null;this.input=null;function b(j){c.val(j);g.change&&g.change(c.val());c.palette.slideUp()}function f(){c.palette=a("<div />").addClass(g.paletteClass+" rounded-3");
for(var j=0;j<g.colors.length;j++){a("<div />").addClass("color").css("background-color",g.colors[j]).attr({title:g.colors[j],unselectable:"on"}).appendTo(c.palette).mouseenter(function(){var k=a(this).attr("title");c.input.val(k);c.preview.css("background-color",k)}).click(function(k){k.stopPropagation();b(a(this).attr("title"))})}c.input=a('<input type="text" />').addClass("rounded-3").attr("size",8).click(function(k){k.stopPropagation();a(this).focus()}).keydown(function(o){if(o.ctrlKey||o.metaKey){return true
}var p=o.keyCode;if(p==27){return c.mouseleave()}if(p!=8&&p!=13&&p!=46&&p!=37&&p!=39&&(p<48||p>57)&&(p<65||p>70)){return false}var q=a(this).val();if(q.length==7||q.length==0){if(p==13){o.stopPropagation();o.preventDefault();b(q);c.palette.slideUp()}if(o.keyCode!=8&&o.keyCode!=46&&p!=37&&p!=39){return false}}}).keyup(function(k){var o=a(this).val();o.length==7&&/^#[0-9abcdef]{6}$/i.test(o)&&c.val(o)});c.preview=a("<div />").addClass("preview rounded-3").click(function(k){k.stopPropagation();b(c.input.val())
});c.palette.append(a("<div />").addClass("clearfix")).append(a("<div />").addClass("panel").append(c.input).append(c.preview));if(g.palettePosition=="outer"){c.palette.hide().appendTo(c.parents("body").eq(0)).mouseleave(function(){if(!c.palette.is(":animated")){a(this).slideUp();c.val(c.val())}});c.mouseleave(function(k){if(k.relatedTarget!=c.palette.get(0)){if(!c.palette.is(":animated")){c.palette.slideUp();c.val(c.val())}}})}else{c.append(c.palette.hide()).mouseleave(function(k){c.palette.slideUp();
c.val(c.val())})}c.val(c.val())}this.empty().addClass(g["class"]+" rounded-3").css({position:"relative","background-color":g.color||""}).click(function(p){if(!c.hasClass("disabled")){!c.palette&&f();if(g.palettePosition=="outer"&&c.palette.css("display")=="none"){var q=a(this).offset();var k=c.palette.width();var j=c.parents("body").width()-q.left>=k?q.left:q.left+a(this).outerWidth()-k;c.palette.css({left:j+"px",top:q.top+a(this).height()+1+"px"})}c.palette.slideToggle()}});this.val=function(j){if(!j&&j!==""){return this.hidden.val()
}else{this.hidden.val(j);if(g.update){g.update(this.hidden.val())}else{this.css("background-color",j)}if(c.palette){c.preview.css("background-color",j);c.input.val(j)}}return this};return this};a.fn.elColorPicker.defaults={"class":"el-colorpicker",paletteClass:"el-palette",palettePosition:"inner",name:"color",color:"",update:null,change:function(b){},colors:["#ffffff","#cccccc","#999999","#666666","#333333","#000000","#ffcccc","#cc9999","#996666","#663333","#330000","#ff9999","#cc6666","#cc3333","#993333","#660000","#ff6666","#ff3333","#ff0000","#cc0000","#990000","#ff9966","#ff6633","#ff3300","#cc3300","#993300","#ffcc99","#cc9966","#cc6633","#996633","#663300","#ff9933","#ff6600","#ff9900","#cc6600","#cc9933","#ffcc66","#ffcc33","#ffcc00","#cc9900","#996600","#ffffcc","#cccc99","#999966","#666633","#333300","#ffff99","#cccc66","#cccc33","#999933","#666600","#ffff66","#ffff33","#ffff00","#cccc00","#999900","#ccff66","#ccff33","#ccff00","#99cc00","#669900","#ccff99","#99cc66","#99cc33","#669933","#336600","#99ff33","#99ff00","#66ff00","#66cc00","#66cc33","#99ff66","#66ff33","#33ff00","#33cc00","#339900","#ccffcc","#99cc99","#669966","#336633","#003300","#99ff99","#66cc66","#33cc33","#339933","#006600","#66ff66","#33ff33","#00ff00","#00cc00","#009900","#66ff99","#33ff66","#00ff33","#00cc33","#009933","#99ffcc","#66cc99","#33cc66","#339966","#006633","#33ff99","#00ff66","#00ff99","#00cc66","#33cc99","#66ffcc","#33ffcc","#00ffcc","#00cc99","#009966","#ccffff","#99cccc","#669999","#336666","#003333","#99ffff","#66cccc","#33cccc","#339999","#006666","#66cccc","#33ffff","#00ffff","#00cccc","#009999","#66ccff","#33ccff","#00ccff","#0099cc","#006699","#99ccff","#6699cc","#3399cc","#336699","#003366","#3399ff","#0099ff","#0066ff","#066ccc","#3366cc","#6699ff","#3366ff","#0033ff","#0033cc","#003399","#ccccff","#9999cc","#666699","#333366","#000033","#9999ff","#6666cc","#3333cc","#333399","#000066","#6666ff","#3333ff","#0000ff","#0000cc","#009999","#9966ff","#6633ff","#3300ff","#3300cc","#330099","#cc99ff","#9966cc","#6633cc","#663399","#330066","#9933ff","#6600ff","#9900ff","#6600cc","#9933cc","#cc66ff","#cc33ff","#cc00ff","#9900cc","#660099","#ffccff","#cc99cc","#996699","#663366","#330033","#ff99ff","#cc66cc","#cc33cc","#993399","#660066","#ff66ff","#ff33ff","#ff00ff","#cc00cc","#990099","#ff66cc","#ff33cc","#ff00cc","#cc0099","#990066","#ff99cc","#cc6699","#cc3399","#993366","#660033","#ff3399","#ff0099","#ff0066","#cc0066","#cc3366","#ff6699","#ff3366","#ff0033","#cc0033","#990033"]}
})(jQuery);(function(a){a.fn.elBorderSelect=function(q){var f=this;var j=this.eq(0);var k=a.extend({},a.fn.elBorderSelect.defaults,q);var c=a('<input type="text" />').attr({name:k.name+"[width]",size:3}).css("text-align","right").change(function(){f.change()});var p=a("<div />").css("position","relative").elColorPicker({"class":"el-colorpicker ui-icon ui-icon-pencil",name:k.name+"[color]",palettePosition:"outer",change:function(){f.change()}});var g=a("<div />").elSelect({tpl:'<div style="border-bottom:4px %val #000;width:100%;margin:7px 0"> </div>',tpls:{"":"%label"},maxHeight:k.styleHeight||null,select:function(){f.change()
},src:{"":"none",solid:"solid",dashed:"dashed",dotted:"dotted","double":"double",groove:"groove",ridge:"ridge",inset:"inset",outset:"outset"}});j.empty().addClass(k["class"]).attr("name",k.name||"").append(a("<table />").attr("cellspacing",0).append(a("<tr />").append(a("<td />").append(c).append(" px")).append(a("<td />").append(g)).append(a("<td />").append(p))));function h(o){function t(u){hexDigits=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return !u?"00":hexDigits[(u-u%16)/16]+hexDigits[u%16]
}var r=(o||"").match(/\(([0-9]{1,3}),\s*([0-9]{1,3}),\s*([0-9]{1,3})\)/);return r?"#"+t(r[1])+t(r[2])+t(r[3]):""}function b(t){if(!t){return t}var r=t.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(r){t=r[1];unit=r[2]}if(t[0]=="."){t="0"+t}t=parseFloat(t);if(isNaN(t)){return""}var o=parseInt(a(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(t*o);case"pt":return parseInt(t*o/12);case"%":return parseInt(t*o/100)}return t}this.change=function(){k.change&&k.change(this.val())
};this.val=function(o){var t,u,z,r,x;if(!o&&o!==""){t=parseInt(c.val());t=!isNaN(t)?t+"px":"";u=g.val();z=p.val();return{width:t,style:u,color:z,css:a.trim(t+" "+u+" "+z)}}else{r="";if(o.nodeName||o.css){if(!o.css){o=a(o)}r=o.css("border");if((r=o.css("border"))){t=u=z=r}else{t=o.css("border-width");u=o.css("border-style");z=o.css("border-color")}}else{t=o.width||"";u=o.style||"";z=o.color||""}c.val(b(t));x=u?u.match(/(solid|dashed|dotted|double|groove|ridge|inset|outset)/i):"";g.val(x?x[1]:"");p.val(z.indexOf("#")===0?z:h(z));
return this}};this.val(k.value);return this};a.fn.elBorderSelect.defaults={name:"el-borderselect","class":"el-borderselect",value:{},change:null}})(jQuery);(function(a){a.fn.elPaddingInput=function(h){var b=this;var g=a.extend({},a.fn.elPaddingInput.defaults,{name:this.attr("name")},h);this.regexps={main:new RegExp(g.type=="padding"?'paddings*:s*([^;"]+)':'margins*:s*([^;"]+)',"im"),left:new RegExp(g.type=="padding"?'padding-lefts*:s*([^;"]+)':'margin-lefts*:s*([^;"]+)',"im"),top:new RegExp(g.type=="padding"?'padding-tops*:s*([^;"]+)':'margin-tops*:s*([^;"]+)',"im"),right:new RegExp(g.type=="padding"?'padding-rights*:s*([^;"]+)':'margin-rights*:s*([^;"]+)',"im"),bottom:new RegExp(g.type=="padding"?'padding-bottoms*:s*([^;"]+)':'margin-bottoms*:s*([^;"]+)',"im")};
a.each(["left","top","right","bottom"],function(){b[this]=a('<input type="text" />').attr("size",3).css("text-align","right").css("border-"+this,"2px solid red").bind("change",function(){a(this).val(c(a(this).val()));f()}).attr("name",g.name+"["+this+"]")});a.each(["uleft","utop","uright","ubottom"],function(){b[this]=a("<select />").append('<option value="px">px</option>').append('<option value="em">em</option>').append('<option value="pt">pt</option>').bind("change",function(){f()}).attr("name",g.name+"["+this+"]");
if(g.percents){b[this].append('<option value="%">%</option>')}});this.empty().addClass(g["class"]).append(this.left).append(this.uleft).append(" x ").append(this.top).append(this.utop).append(" x ").append(this.right).append(this.uright).append(" x ").append(this.bottom).append(this.ubottom);this.val=function(q){if(!q&&q!==""){var z=c(this.left.val());var k=c(this.top.val());var j=c(this.right.val());var A=c(this.bottom.val());var x={left:z=="auto"||z==0?z:(z!==""?z+this.uleft.val():""),top:k=="auto"||k==0?k:(k!==""?k+this.utop.val():""),right:j=="auto"||j==0?j:(j!==""?j+this.uright.val():""),bottom:A=="auto"||A==0?A:(A!==""?A+this.ubottom.val():""),css:""};
if(x.left!==""&&x.right!==""&&x.top!==""&&x.bottom!==""){if(x.left==x.right&&x.top==x.bottom){x.css=x.top+" "+x.left}else{x.css=x.top+" "+x.right+" "+x.bottom+" "+x.left}}return x}else{if(q.nodeName||q.css){if(!q.css){q=a(q)}var w={left:"",top:"",right:"",bottom:""};var p=(q.attr("style")||"").toLowerCase();if(p){p=a.trim(p);var u=p.match(this.regexps.main);if(u){var o=a.trim(u[1]).replace(/\s+/g," ").split(" ",4);w.top=o[0];w.right=o[1]&&o[1]!==""?o[1]:w.top;w.bottom=o[2]&&o[2]!==""?o[2]:w.top;w.left=o[3]&&o[3]!==""?o[3]:w.right
}else{a.each(["left","top","right","bottom"],function(){var r=this.toString();u=p.match(b.regexps[r]);if(u){w[r]=u[1]}})}}var q=w}a.each(["left","top","right","bottom"],function(){var r=this.toString();b[r].val("");b["u"+r].val();if(typeof(q[r])!="undefined"&&q[r]!==null){q[r]=q[r].toString();var t=c(q[r]);b[r].val(t);var v=q[r].match(/(px|em|pt|%)/i);b["u"+r].val(v?v[1]:"px")}});return this}};function c(j){j=a.trim(j.toString());if(j[0]=="."){j="0"+j}n=parseFloat(j);return !isNaN(n)?n:(j=="auto"?j:"")
}function f(){g.change&&g.change(b)}this.val(g.value);return this};a.fn.elPaddingInput.defaults={name:"el-paddinginput","class":"el-paddinginput",type:"padding",value:{},percents:true,change:null}})(jQuery);(function(a){a.fn.elSelect=function(u){var c=this;var h=this.eq(0);var p=a.extend({},a.fn.elSelect.defaults,u);var r=a('<input type="hidden" />').attr("name",p.name);var q=a("<label />").attr({unselectable:"on"}).addClass("rounded-left-3");var b=null;var g=null;if(h.get(0).nodeName=="SELECT"){p.src={};
h.children("option").each(function(){p.src[a(this).val()]=a(this).text()});p.value=h.val();p.name=h.attr("name");h.replaceWith((h=a("<div />")))}if(!p.value||!p.src[p.val]){p.value=null;var f=0;for(var j in p.src){if(f++==0){p.value=j}}}this.val=function(o){if(!o&&o!==""){return r.val()}else{if(p.src[o]){r.val(o);t(o);if(b){b.children().each(function(){if(a(this).attr("name")==o){a(this).addClass("active")}else{a(this).removeClass("active")}})}}return this}};function t(w){var o=p.labelTpl||p.tpls[w]||p.tpl;
q.html(o.replace(/%val/g,w).replace(/%label/,p.src[w])).children().attr({unselectable:"on"})}h.empty().addClass(p["class"]+" rounded-3").attr({unselectable:"on"}).append(r).append(q).hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).click(function(o){!b&&k();b.slideToggle();if(a.browser.msie&&!g){b.children().each(function(){g=Math.max(g,a(this).width())});if(g>b.width()){b.width(g+40)}}});this.val(p.value);function k(){b=a("<div />").addClass(p.listClass+" rounded-3").hide().appendTo(h.mouseleave(function(v){b.slideUp()
}));for(var x in p.src){var o=p.tpls[x]||p.tpl;a("<div />").attr("name",x).append(a(o.replace(/%val/g,x).replace(/%label/g,p.src[x])).attr({unselectable:"on"})).appendTo(b).hover(function(){a(this).addClass("hover")},function(){a(this).removeClass("hover")}).click(function(B){B.stopPropagation();B.preventDefault();var w=a(this).attr("name");c.val(w);p.select(w);b.slideUp()})}var z=h.outerWidth();if(b.width()<z){b.width(z)}var A=b.height();if(p.maxHeight>0&&A>p.maxHeight){b.height(p.maxHeight)}c.val(r.val())
}return this};a.fn.elSelect.defaults={name:"el-select","class":"el-select",listClass:"list",labelTpl:null,tpl:"<%val>%label</%val>",tpls:{},value:null,src:{},select:function(b){window.console&&window.console.log&&window.console.log("selected: "+b)},maxHeight:410}})(jQuery);(function(a){elRTE=function(f,j){if(!f||!f.nodeName){return alert('elRTE: argument "target" is not DOM Element')}var b=this,o;this.version="1.3";this.build="2011-06-23";this.options=a.extend(true,{},this.options,j);this.browser=a.browser;
this.target=a(f);this.lang=(""+this.options.lang);this._i18n=new eli18n({textdomain:"rte",messages:{rte:this.i18Messages[this.lang]||{}}});this.rtl=!!(/^(ar|fa|he)$/.test(this.lang)&&this.i18Messages[this.lang]);if(this.rtl){this.options.cssClass+=" el-rte-rtl"}this.toolbar=a('<div class="toolbar"/>');this.iframe=document.createElement("iframe");this.iframe.setAttribute("frameborder",0);this.workzone=a('<div class="workzone"/>').append(this.iframe).append(this.source);this.statusbar=a('<div class="statusbar"/>');
this.tabsbar=a('<div class="tabsbar"/>');this.editor=a('<div class="'+this.options.cssClass+'" />').append(this.toolbar).append(this.workzone).append(this.statusbar).append(this.tabsbar);this.doc=null;this.$doc=null;this.window=null;this.utils=new this.utils(this);this.dom=new this.dom(this);this.filter=new this.filter(this);this.updateHeight=function(){b.workzone.add(b.iframe).add(b.source).height(b.workzone.height())};this.resizable=function(q){var p=this;if(this.options.resizable&&a.fn.resizable){if(q){this.editor.resizable({handles:"se",alsoResize:this.workzone,minWidth:300,minHeight:200}).bind("resize",p.updateHeight)
}else{this.editor.resizable("destroy").unbind("resize",p.updateHeight)}}};this.editor.insertAfter(f);var c="";if(f.nodeName=="TEXTAREA"){this.source=this.target;this.source.insertAfter(this.iframe).hide();c=this.target.val()}else{this.source=a("<textarea />").insertAfter(this.iframe).hide();c=this.target.hide().html()}this.source.attr("name",this.target.attr("name")||this.target.attr("id"));c=a.trim(c);if(!c){c=" "}if(this.options.allowSource){this.tabsbar.append('<div class="tab editor rounded-bottom-7 active">'+b.i18n("Editor")+'</div><div class="tab source rounded-bottom-7">'+b.i18n("Source")+'</div><div class="clearfix" style="clear:both"/>').children(".tab").click(function(p){if(!a(this).hasClass("active")){b.tabsbar.children(".tab").toggleClass("active");
b.workzone.children().toggle();if(a(this).hasClass("editor")){b.updateEditor();b.window.focus();b.ui.update(true)}else{b.updateSource();b.source.focus();if(a.browser.msie){}else{b.source[0].setSelectionRange(0,0)}b.ui.disable();b.statusbar.empty()}}})}this.window=this.iframe.contentWindow;this.doc=this.iframe.contentWindow.document;this.$doc=a(this.doc);o='<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';a.each(b.options.cssfiles,function(){o+='<link rel="stylesheet" type="text/css" href="'+this+'" />'
});this.doc.open();var h=this.filter.wysiwyg(c),g=this.rtl?' class="el-rte-rtl"':"";this.doc.write(b.options.doctype+o+"</head><body"+g+">"+(h)+"</body></html>");this.doc.close();if(a.browser.msie){this.doc.body.contentEditable=true}else{try{this.doc.designMode="on"}catch(k){}this.doc.execCommand("styleWithCSS",false,this.options.styleWithCSS)}if(this.options.height>0){this.workzone.height(this.options.height)}if(this.options.width>0){this.editor.width(this.options.width)}this.updateHeight();this.resizable(true);
this.window.focus();this.history=new this.history(this);this.selection=new this.selection(this);this.ui=new this.ui(this);this.target.parents("form").bind("submit.elfinder",function(p){b.source.parents("form").find('[name="el-select"]').remove();b.beforeSave()});this.source.bind("keydown",function(u){if(u.keyCode==9){u.preventDefault();if(a.browser.msie){var q=document.selection.createRange();q.text="\t"+q.text;this.focus()}else{var p=this.value.substr(0,this.selectionStart),t=this.value.substr(this.selectionEnd);
this.value=p+"\t"+t;this.setSelectionRange(p.length+1,p.length+1)}}});a(this.doc.body).bind("dragend",function(p){setTimeout(function(){try{b.window.focus();var r=b.selection.getBookmark();b.selection.moveToBookmark(r);b.ui.update()}catch(q){}},200)});this.typing=false;this.lastKey=null;this.$doc.bind("mouseup",function(){b.typing=false;b.lastKey=null;b.ui.update()}).bind("keyup",function(p){if((p.keyCode>=8&&p.keyCode<=13)||(p.keyCode>=32&&p.keyCode<=40)||p.keyCode==46||(p.keyCode>=96&&p.keyCode<=111)){b.ui.update()
}}).bind("keydown",function(q){if((q.metaKey||q.ctrlKey)&&q.keyCode==65){b.ui.update()}else{if(q.keyCode==13){var p=b.selection.getNode();if(b.dom.selfOrParent(p,/^PRE$/)){b.selection.insertNode(b.doc.createTextNode("\r\n"));return false}else{if(a.browser.safari&&q.shiftKey){b.selection.insertNode(b.doc.createElement("br"));return false}}}}if((q.keyCode>=48&&q.keyCode<=57)||q.keyCode==61||q.keyCode==109||(q.keyCode>=65&&q.keyCode<=90)||q.keyCode==188||q.keyCode==190||q.keyCode==191||(q.keyCode>=219&&q.keyCode<=222)){if(!b.typing){b.history.add(true)
}b.typing=true;b.lastKey=null}else{if(q.keyCode==8||q.keyCode==46||q.keyCode==32||q.keyCode==13){if(q.keyCode!=b.lastKey){b.history.add(true)}b.lastKey=q.keyCode;b.typing=false}}}).bind("paste",function(t){if(!b.options.allowPaste){t.stopPropagation();t.preventDefault()}else{var p=a(b.dom.create("div"))[0],q=b.doc.createTextNode("_");b.history.add(true);b.typing=true;b.lastKey=null;p.appendChild(q);b.selection.deleteContents().insertNode(p);b.selection.select(q);setTimeout(function(){if(p.parentNode){a(p).html(b.filter.proccess("paste",a(p).html()));
q=p.lastChild;b.dom.unwrap(p);if(q){b.selection.select(q);b.selection.collapse(false)}}else{p.parentNode&&p.parentNode.removeChild(p);b.val(b.filter.proccess("paste",b.filter.wysiwyg2wysiwyg(a(b.doc.body).html())));b.selection.select(b.doc.body.firstChild);b.selection.collapse(true)}a(b.doc.body).mouseup()},15)}});if(a.browser.msie){this.$doc.bind("keyup",function(p){if(p.keyCode==86&&(p.metaKey||p.ctrlKey)){b.history.add(true);b.typing=true;b.lastKey=null;b.selection.saveIERange();b.val(b.filter.proccess("paste",b.filter.wysiwyg2wysiwyg(a(b.doc.body).html())));
b.selection.restoreIERange();a(b.doc.body).mouseup();this.ui.update()}})}if(a.browser.safari){this.$doc.bind("click",function(p){a(b.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl");if(p.target.nodeName=="IMG"){a(p.target).addClass("elrte-webkit-hl")}}).bind("keyup",function(p){a(b.doc.body).find(".elrte-webkit-hl").removeClass("elrte-webkit-hl")})}this.window.focus();this.destroy=function(){this.updateSource();this.target.is("textarea")?this.target.val(a.trim(this.source.val())):this.target.html(a.trim(this.source.val()));
this.editor.remove();this.target.show().parents("form").unbind("submit.elfinder")}};elRTE.prototype.i18n=function(b){return this._i18n.translate(b)};elRTE.prototype.open=function(){this.editor.show()};elRTE.prototype.close=function(){this.editor.hide()};elRTE.prototype.updateEditor=function(){this.val(this.source.val())};elRTE.prototype.updateSource=function(){this.source.val(this.filter.source(a(this.doc.body).html()))};elRTE.prototype.val=function(b){if(typeof(b)=="string"){b=""+b;if(this.source.is(":visible")){this.source.val(this.filter.source2source(b))
}else{if(a.browser.msie){this.doc.body.innerHTML="<br />"+this.filter.wysiwyg(b);this.doc.body.removeChild(this.doc.body.firstChild)}else{this.doc.body.innerHTML=this.filter.wysiwyg(b)}}}else{if(this.source.is(":visible")){return a.trim(this.filter.source2source(this.source.val()))}else{return a.trim(this.filter.source(a(this.doc.body).html()))}}};elRTE.prototype.beforeSave=function(){this.source.val(a.trim(this.val())||"")};elRTE.prototype.save=function(){this.beforeSave();this.editor.parents("form").submit()
};elRTE.prototype.log=function(b){if(window.console&&window.console.log){window.console.log(b)}};elRTE.prototype.i18Messages={};a.fn.elrte=function(g,b){var f=typeof(g)=="string"?g:"",c;this.each(function(){if(!this.elrte){this.elrte=new elRTE(this,typeof(g)=="object"?g:{})}switch(f){case"open":case"show":this.elrte.open();break;case"close":case"hide":this.elrte.close();break;case"updateSource":this.elrte.updateSource();break;case"destroy":this.elrte.destroy()}});if(f=="val"){if(!this.length){return""
}else{if(this.length==1){return b||b===""?this[0].elrte.val(b):this[0].elrte.val()}else{c={};this.each(function(){c[this.elrte.source.attr("name")]=this.elrte.val()});return c}}}return this}})(jQuery);(function(a){elRTE.prototype.dom=function(c){this.rte=c;var b=this;this.regExp={textNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TD|TH|TT|VAR)$/,textContainsNodes:/^(A|ABBR|ACRONYM|ADDRESS|B|BDO|BIG|BLOCKQUOTE|CAPTION|CENTER|CITE|CODE|DD|DEL|DFN|DIV|DL|DT|EM|FIELDSET|FONT|H[1-6]|I|INS|KBD|LABEL|LEGEND|LI|MARQUEE|NOBR|NOEMBED|OL|P|PRE|Q|SAMP|SMALL|SPAN|STRIKE|STRONG|SUB|SUP|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|TT|UL|VAR)$/,block:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TABLE|THEAD|TBODY|TFOOT|TD|TH|TR|UL)$/,selectionBlock:/^(APPLET|BLOCKQUOTE|BR|CAPTION|CENTER|COL|COLGROUP|DD|DIV|DL|DT|H[1-6]|EMBED|FIELDSET|LI|MARQUEE|NOBR|OBJECT|OL|P|PRE|TD|TH|TR|UL)$/,header:/^H[1-6]$/,formElement:/^(FORM|INPUT|HIDDEN|TEXTAREA|SELECT|BUTTON)$/};
this.root=function(){return this.rte.body};this.create=function(f){return this.rte.doc.createElement(f)};this.createBookmark=function(){var f=this.rte.doc.createElement("span");f.id="elrte-bm-"+Math.random().toString().substr(2);a(f).addClass("elrtebm elrte-protected");return f};this.indexOf=function(f){var g=0;f=a(f);while((f=f.prev())&&f.length){g++}return g};this.attr=function(g,h){var f="";if(g.nodeType==1){f=a(g).attr(h);if(f&&h!="src"&&h!="href"&&h!="title"&&h!="alt"){f=f.toString().toLowerCase()
}}return f||""};this.findCommonAncestor=function(o,g){if(!o||!g){return this.rte.log("dom.findCommonAncestor invalid arguments")}if(o==g){return o}else{if(o.nodeName=="BODY"||g.nodeName=="BODY"){return this.rte.doc.body}}var h=a(o).parents(),k=a(g).parents(),f=k.length-1,p=k[f];for(var j=h.length-1;j>=0;j--,f--){if(h[j]==k[f]){p=h[j]}else{break}}return p};this.isEmpty=function(f){if(f.nodeType==1){return this.regExp.textNodes.test(f.nodeName)?a.trim(a(f).text()).length==0:false}else{if(f.nodeType==3){return/^(TABLE|THEAD|TFOOT|TBODY|TR|UL|OL|DL)$/.test(f.parentNode.nodeName)||f.nodeValue==""||(a.trim(f.nodeValue).length==0&&!(f.nextSibling&&f.previousSibling&&f.nextSibling.nodeType==1&&f.previousSibling.nodeType==1&&!this.regExp.block.test(f.nextSibling.nodeName)&&!this.regExp.block.test(f.previousSibling.nodeName)))
}}return true};this.next=function(f){while(f.nextSibling&&(f=f.nextSibling)){if(f.nodeType==1||(f.nodeType==3&&!this.isEmpty(f))){return f}}return null};this.prev=function(f){while(f.previousSibling&&(f=f.previousSibling)){if(f.nodeType==1||(f.nodeType==3&&!this.isEmpty(f))){return f}}return null};this.isPrev=function(f,g){while((f=this.prev(f))){if(f==g){return true}}return false};this.nextAll=function(f){var g=[];while((f=this.next(f))){g.push(f)}return g};this.prevAll=function(f){var g=[];while((f=this.prev(f))){g.push(f)
}return g};this.toLineEnd=function(f){var g=[];while((f=this.next(f))&&f.nodeName!="BR"&&f.nodeName!="HR"&&this.isInline(f)){g.push(f)}return g};this.toLineStart=function(f){var g=[];while((f=this.prev(f))&&f.nodeName!="BR"&&f.nodeName!="HR"&&this.isInline(f)){g.unshift(f)}return g};this.isFirstNotEmpty=function(f){while((f=this.prev(f))){if(f.nodeType==1||(f.nodeType==3&&a.trim(f.nodeValue)!="")){return false}}return true};this.isLastNotEmpty=function(f){while((f=this.next(f))){if(!this.isEmpty(f)){return false
}}return true};this.isOnlyNotEmpty=function(f){return this.isFirstNotEmpty(f)&&this.isLastNotEmpty(f)};this.findLastNotEmpty=function(f){this.rte.log("findLastNotEmpty Who is here 0_o");if(f.nodeType==1&&(l=f.lastChild)){if(!this.isEmpty(l)){return l}while(l.previousSibling&&(l=l.previousSibling)){if(!this.isEmpty(l)){return l}}}return false};this.isInline=function(h){if(h.nodeType==3){return true}else{if(h.nodeType==1){h=a(h);var g=h.css("display");var j=h.css("float");return g=="inline"||g=="inline-block"||j=="left"||j=="right"
}}return true};this.is=function(g,h){if(g&&g.nodeName){if(typeof(h)=="string"){h=this.regExp[h]||/.?/}if(h instanceof RegExp&&g.nodeName){return h.test(g.nodeName)}else{if(typeof(h)=="function"){return h(g)}}}return false};this.filter=function(f,j){var g=[],h;if(!f.push){return this.is(f,j)?f:null}for(h=0;h<f.length;h++){if(this.is(f[h],j)){g.push(f[h])}}return g};this.parents=function(f,h){var g=[];while(f&&(f=f.parentNode)&&f.nodeName!="BODY"&&f.nodeName!="HTML"){if(this.is(f,h)){g.push(f)}}return g
};this.parent=function(g,h){return this.parents(g,h)[0]||null};this.selfOrParent=function(f,h,g){return this.is(f,h)?f:this.parent(f,g||h)};this.selfOrParentLink=function(f){f=this.selfOrParent(f,/^A$/);return f&&f.href?f:null};this.selfOrParentAnchor=function(f){f=this.selfOrParent(f,/^A$/);return f&&!f.href&&f.name?f:null};this.childLinks=function(f){var g=[];a("a[href]",f).each(function(){g.push(this)});return g};this.selectionHas=function(j){var g=this.rte.selection.cloneContents(),h;if(g&&g.childNodes&&g.childNodes.length){for(h=0;
h<g.childNodes.length;h++){if(typeof(j)=="function"){if(j(g.childNodes[h])){return true}}else{if(g instanceof RegExp){if(j.test(g.childNodes[h].nodeName)){return true}}}}}return false};this.wrap=function(f,g){f=a.isArray(f)?f:[f];g=g.nodeName?g:this.create(g);if(f[0]&&f[0].nodeType&&f[0].parentNode){g=f[0].parentNode.insertBefore(g,f[0]);a(f).each(function(){if(this!=g){g.appendChild(this)}})}return g};this.unwrap=function(f){if(f&&f.parentNode){while(f.firstChild){f.parentNode.insertBefore(f.firstChild,f)
}f.parentNode.removeChild(f)}};this.wrapContents=function(f,g){g=g.nodeName?g:this.create(g);for(var h=0;h<f.childNodes.length;h++){g.appendChild(f.childNodes[h])}f.appendChild(g);return g};this.cleanNode=function(f){if(f.nodeType!=1){return}if(/^(P|LI)$/.test(f.nodeName)&&(l=this.findLastNotEmpty(f))&&l.nodeName=="BR"){a(l).remove()}$n=a(f);$n.children().each(function(){this.cleanNode(this)});if(f.nodeName!="BODY"&&!/^(TABLE|TR|TD)$/.test(f)&&this.isEmpty(f)){return $n.remove()}if($n.attr("style")===""){$n.removeAttr("style")
}if(this.rte.browser.safari&&$n.hasClass("Apple-span")){$n.removeClass("Apple-span")}if(f.nodeName=="SPAN"&&!$n.attr("style")&&!$n.attr("class")&&!$n.attr("id")){$n.replaceWith($n.html())}};this.cleanChildNodes=function(f){var g=this.cleanNode;a(f).children().each(function(){g(this)})};this.tableMatrix=function(f){var j=[];if(f&&f.nodeName=="TABLE"){var h=0;function g(o){for(var k=0;k<=h;k++){if(!j[o][k]){return k}}}a(f).find("tr").each(function(k){if(!a.isArray(j[k])){j[k]=[]}a(this).children("td,th").each(function(){var p=parseInt(a(this).attr("colspan")||1);
var u=parseInt(a(this).attr("rowspan")||1);var t=g(k);for(var r=0;r<u;r++){for(var v=0;v<p;v++){var q=k+r;if(!a.isArray(j[q])){j[q]=[]}var o=v==0&&r==0?this:(r==0?v:"-");j[q][t+v]=o}}h=Math.max(h,j[k].length)})})}return j};this.indexesOfCell=function(f,g){for(var j=0;j<g.length;j++){for(var h=0;h<g[j].length;h++){if(g[j][h]==f){return[j,h]}}}};this.fixTable=function(g){if(g&&g.nodeName=="TABLE"){var h=a(g);var p=this.tableMatrix(g);var q=0;a.each(p,function(){q=Math.max(q,this.length)});if(q==0){return h.remove()
}for(var o=0;o<p.length;o++){var f=p[o].length;if(f==0){h.find("tr").eq(o).remove()}else{if(f<q){var k=q-f;var j=h.find("tr").eq(o);for(i=0;i<k;i++){j.append("<td>&nbsp;</td>")}}}}}};this.tableColumn=function(t,p,v){t=this.selfOrParent(t,/^TD|TH$/);var g=this.selfOrParent(t,/^TABLE$/);ret=[];info={offset:[],delta:[]};if(t&&g){v&&this.fixTable(g);var q=this.tableMatrix(g);var h=false;var f;for(var j=0;j<q.length;j++){for(var k=0;k<q[j].length;k++){if(q[j][k]==t){f=k;h=true;break}}if(h){break}}if(f>=0){for(var j=0;
j<q.length;j++){var o=q[j][f]||null;if(o){if(o.nodeName){ret.push(o);if(p){info.delta.push(0);info.offset.push(f)}}else{var u=parseInt(o);if(!isNaN(u)&&q[j][f-u]&&q[j][f-u].nodeName){ret.push(q[j][f-u]);if(p){info.delta.push(u);info.offset.push(f)}}}}}}}return !p?ret:{column:ret,info:info}}}})(jQuery);(function(a){elRTE.prototype.filter=function(f){var c=this,b=a("<span/>").addClass("elrtetesturl").appendTo(document.body)[0];this.url=(typeof(b.currentStyle)!="undefined"?b.currentStyle.backgroundImage:document.defaultView.getComputedStyle(b,null)["backgroundImage"]).replace(/^url\((['"]?)([\s\S]+\/)[\s\S]+\1\)$/i,"$2");
a(b).remove();this.rte=f;this.xhtml=/xhtml/i.test(f.options.doctype);this.boolAttrs=f.utils.makeObject("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(","));this.tagRegExp=/<(\/?)([\w:]+)((?:\s+[a-z\-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g;this.openTagRegExp=/<([\w:]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*\/?>/g;this.attrRegExp=/(\w+)(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^\s]+))?/g;this.scriptRegExp=/<script([^>]*)>([\s\S]*?)<\/script>/gi;
this.styleRegExp=/(<style([^>]*)>[\s\S]*?<\/style>)/gi;this.linkRegExp=/(<link([^>]+)>)/gi;this.cdataRegExp=/<!\[CDATA\[([\s\S]+)\]\]>/g;this.objRegExp=/<object([^>]*)>([\s\S]*?)<\/object>/gi;this.embRegExp=/<(embed)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi;this.paramRegExp=/<(param)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*>/gi;this.iframeRegExp=/<iframe([^>]*)>([\s\S]*?)<\/iframe>/gi;this.yMapsRegExp=/<div\s+([^>]*id\s*=\s*('|")?YMapsID[^>]*)>/gi;this.gMapsRegExp=/<iframe\s+([^>]*src\s*=\s*"http:\/\/maps\.google\.\w+[^>]*)>([\s\S]*?)<\/iframe>/gi;
this.videoHostRegExp=/^(http:\/\/[\w\.]*)?(youtube|vimeo|rutube).*/i;this.serviceClassRegExp=/<(\w+)([^>]*class\s*=\s*"[^>]*elrte-[^>]*)>\s*(<\/\1>)?/gi;this.pagebreakRegExp=/<(\w+)([^>]*style\s*=\s*"[^>]*page-break[^>]*)>\s*(<\/\1>)?/gi;this.pbRegExp=new RegExp("<!-- pagebreak -->","gi");this.allowTags=f.options.allowTags.length?f.utils.makeObject(f.options.allowTags):null;this.denyTags=f.options.denyTags.length?f.utils.makeObject(f.options.denyTags):null;this.denyAttr=f.options.denyAttr?f.utils.makeObject(f.options.denyAttr):null;
this.pasteDenyAttr=f.options.pasteDenyAttr?f.utils.makeObject(f.options.pasteDenyAttr):null;this.fontSize=["medium","xx-small","small","medium","large","x-large","xx-large"];this.fontFamily={"sans-serif":/^(arial|tahoma|verdana)$/i,serif:/^(times|times new roman)$/i,monospace:/^courier$/i};this.scripts={};this._chains={};a.each(this.chains,function(g){c._chains[g]=[];a.each(this,function(j,h){typeof(c.rules[h])=="function"&&c._chains[g].push(c.rules[h])})});this.proccess=function(h,g){g=a.trim(g).replace(/^\s*(&nbsp;)+/gi,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,"");
a.each(this._chains[h]||[],function(){g=this.call(c,g)});g=g.replace(/\t/g,"  ").replace(/\r/g,"").replace(/\s*\n\s*\n+/g,"\n")+"  ";return a.trim(g)?g:" "};this.wysiwyg=function(g){return this.proccess("wysiwyg",g)};this.source=function(g){return this.proccess("source",g)};this.source2source=function(g){return this.proccess("source2source",g)};this.wysiwyg2wysiwyg=function(g){return this.proccess("wysiwyg2wysiwyg",g)};this.parseAttrs=function(p){var o={},j=this.boolAttrs,q=p.match(this.attrRegExp),k,h,g;
q&&a.each(q,function(t,r){k=r.split("=");h=a.trim(k[0]).toLowerCase();if(k.length>2){k.shift();g=k.join("=")}else{g=j[h]||k[1]||""}o[h]=a.trim(g).replace(/^('|")(.*)(\1)$/,"$2")});o.style=this.rte.utils.parseStyle(o.style);o["class"]=this.rte.utils.parseClass(o["class"]||"");return o};this.serializeAttrs=function(h,k){var j=[],g=this;a.each(h,function(p,o){if(p=="style"){o=g.rte.utils.serializeStyle(o,k)}else{if(p=="class"){o=g.rte.utils.serializeClass(o)}}o&&j.push(p+'="'+o+'"')});return j.join(" ")
};this.cleanAttrs=function(j,h){var g=this,o=this.replaceAttrs;a.each(j["class"],function(p){/^(Apple-style-span|mso\w+)$/i.test(p)&&delete j["class"][p]});function k(p){return p+(/\d$/.test(p)?"px":"")}a.each(j,function(q,p){o[q]&&o[q].call(g,j,h);if(q=="style"){a.each(p,function(r,t){switch(r){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":j.style[r.replace(/^mso-|-alt$/g,"")]=k(t);
delete j.style[r];break;case"horiz-align":j.style["text-align"]=t;delete j.style[r];break;case"vert-align":j.style["vertical-align"]=t;delete j.style[r];break;case"font-color":case"mso-foreground":j.style.color=t;delete j.style[r];break;case"mso-background":case"mso-highlight":j.style.background=t;delete j.style[r];break;case"mso-default-height":j.style["min-height"]=k(t);delete j.style[r];break;case"mso-default-width":j.style["min-width"]=k(t);delete j.style[r];break;case"mso-padding-between-alt":j.style["border-collapse"]="separate";
j.style["border-spacing"]=k(t);delete j.style[r];break;case"text-line-through":if(t.match(/(single|double)/i)){j.style["text-decoration"]="line-through"}delete j.style[r];break;case"mso-zero-height":if(t=="yes"){j.style.display="none"}delete j.style[r];break;case"font-weight":if(t==700){j.style["font-weight"]="bold"}break;default:if(r.match(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/)){delete j.style[r]
}}})}});return j}};elRTE.prototype.filter.prototype.replaceTags={b:{tag:"strong"},big:{tag:"span",style:{"font-size":"large"}},center:{tag:"div",style:{"text-align":"center"}},i:{tag:"em"},font:{tag:"span"},nobr:{tag:"span",style:{"white-space":"nowrap"}},menu:{tag:"ul"},plaintext:{tag:"pre"},s:{tag:"strike"},small:{tag:"span",style:{"font-size":"small"}},u:{tag:"span",style:{"text-decoration":"underline"}},xmp:{tag:"pre"}};elRTE.prototype.filter.prototype.replaceAttrs={align:function(c,b){switch(b){case"img":c.style[c.align.match(/(left|right)/)?"float":"vertical-align"]=c.align;
break;case"table":if(c.align=="center"){c.style["margin-left"]=c.style["margin-right"]="auto"}else{c.style["float"]=c.align}break;default:c.style["text-align"]=c.align}delete c.align},border:function(b){!b.style["border-width"]&&(b.style["border-width"]=(parseInt(b.border)||1)+"px");!b.style["border-style"]&&(b.style["border-style"]="solid");delete b.border},bordercolor:function(b){!b.style["border-color"]&&(b.style["border-color"]=b.bordercolor);delete b.bordercolor},background:function(b){!b.style["background-image"]&&(b.style["background-image"]="url("+b.background+")");
delete b.background},bgcolor:function(b){!b.style["background-color"]&&(b.style["background-color"]=b.bgcolor);delete b.bgcolor},clear:function(b){b.style.clear=b.clear=="all"?"both":b.clear;delete b.clear},color:function(b){!b.style.color&&(b.style.color=b.color);delete b.color},face:function(b){var c=b.face.toLowerCase();a.each(this.fontFamily,function(f,g){if(c.match(g)){b.style["font-family"]=c+","+f}});delete b.face},hspace:function(f,c){if(c=="img"){var b=parseInt(f.hspace)||0;!f.style["margin-left"]&&(f.style["margin-left"]=b+"px");
!f.style["margin-right"]&&(f.style["margin-right"]=b+"px");delete f.hspace}},size:function(c,b){if(b!="input"){c.style["font-size"]=this.fontSize[parseInt(c.size)||0]||"medium";delete c.size}},valign:function(b){if(!b.style["vertical-align"]){b.style["vertical-align"]=b.valign}delete b.valign},vspace:function(f,c){if(c=="img"){var b=parseInt(f.vspace)||0;!f.style["margin-top"]&&(f.style["margin-top"]=b+"px");!f.style["margin-bottom"]&&(f.style["margin-bottom"]=b+"px");delete f.hspace}}};elRTE.prototype.filter.prototype.rules={allowedTags:function(c){var b=this.allowTags;
return b?c.replace(this.tagRegExp,function(g,h,f){return b[f.toLowerCase()]?g:""}):c},deniedTags:function(c){var b=this.denyTags;return b?c.replace(this.tagRegExp,function(g,h,f){return b[f.toLowerCase()]?"":g}):c},clean:function(j){var c=this,g=this.replaceTags,h=this.replaceAttrs,f=this.denyAttr,b;j=j.replace(/<!DOCTYPE([\s\S]*)>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s&nbsp;]*)<\/span>/gi,"$1").replace(/(<p[^>]*>\s*<\/p>|<p[^>]*\/>)/gi,"<br>").replace(/(<\/p>)(?:\s*<br\s*\/?>\s*|\s*&nbsp;\s*)+\s*(<p[^>]*>)/gi,function(o,k,p){return k+"\n"+p
}).replace(this.tagRegExp,function(p,q,k,o){k=k.toLowerCase();if(q){return"</"+(g[k]?g[k].tag:k)+">"}o=c.cleanAttrs(c.parseAttrs(o||""),k);if(g[k]){g[k].style&&a.extend(o.style,g[k].style);k=g[k].tag}f&&a.each(o,function(r){if(f[r]){delete o[r]}});o=c.serializeAttrs(o);return"<"+k+(o?" ":"")+o+">"});b=a("<div>"+j+"</div>");b.find("span:not([id]):not([class])").each(function(){var k=a(this);if(!k.attr("style")){a.trim(k.html()).length?c.rte.dom.unwrap(this):k.remove()}}).end().find("span span:only-child").each(function(){var k=a(this),r=k.parent().eq(0),w=k.attr("id"),u=r.attr("id"),q,o,v;
if(c.rte.dom.isOnlyNotEmpty(this)&&(!w||!u)){v=a.trim(r.attr("class")+" "+k.attr("class"));v&&r.attr("class",v);o=c.rte.utils.serializeStyle(a.extend(c.rte.utils.parseStyle(a(this).attr("style")||""),c.rte.utils.parseStyle(a(r).attr("style")||"")));o&&r.attr("style",o);q=w||u;q&&r.attr("id",q);this.firstChild?a(this.firstChild).unwrap():k.remove()}}).end().find("a[name]").each(function(){a(this).addClass("elrte-protected elrte-anchor")});return b.html()},cleanPaste:function(f){var c=this,b=this.pasteDenyAttr;
f=f.replace(this.scriptRegExp,"").replace(this.styleRegExp,"").replace(this.linkRegExp,"").replace(this.cdataRegExp,"").replace(/\<\!--[\s\S]*?--\>/g,"");if(this.rte.options.pasteOnlyText){f=f.replace(this.tagRegExp,function(h,j,g){return/br/i.test(g)||(j&&/h[1-6]|p|ol|ul|li|div|blockquote|tr/i)?"<br>":""}).replace(/(&nbsp;|<br[^>]*>)+\s*$/gi,"")}else{if(b){f=f.replace(this.openTagRegExp,function(j,g,h){h=c.parseAttrs(h);a.each(h,function(k){if(b[k]){delete h[k]}});h=c.serializeAttrs(h,true);return"<"+g+(h?" ":"")+h+">"
})}}return f},replace:function(c){var j=this,f=this.rte.options.replace||[],o;if(f.length){a.each(f,function(r,t){if(typeof(t)=="function"){c=t.call(j,c)}})}function b(E,r){var u=B(),D=u&&j.videoHostRegExp.test(u)?u.replace(j.videoHostRegExp,"$2"):r.replace(/^\w+\/(.+)/,"$1"),z=parseInt((E.obj?E.obj.width||E.obj.style.width:0)||(E.embed?E.embed.width||E.embed.style.width:0))||150,x=parseInt((E.obj?E.obj.height||E.obj.style.height:0)||(E.embed?E.embed.height||E.embed.style.height:0))||100,A="media"+Math.random().toString().substring(2),v="",C;
function B(){if(E.embed&&E.embed.src){return E.embed.src}if(E.params&&E.params.length){C=E.params.length;while(C--){if(E.params[C].name=="src"||E.params[C].name=="movie"){return E.params[C].value}}}}if(E.obj&&E.obj.style&&E.obj.style["float"]){v=' style="float:'+E.obj.style["float"]+'"'}j.scripts[A]=E;return'<img src="'+j.url+'pixel.gif" class="elrte-media elrte-media-'+D+' elrte-protected" title="'+(u?j.rte.utils.encode(u):"")+'" rel="'+A+'" width="'+z+'" height="'+x+'"'+v+">"}c=c.replace(this.styleRegExp,"<!-- ELRTE_COMMENT$1 -->").replace(this.linkRegExp,"<!-- ELRTE_COMMENT$1-->").replace(this.cdataRegExp,"<!--[CDATA[$1]]-->").replace(this.scriptRegExp,function(u,r,w){var v;
if(j.denyTags.script){return""}v="script"+Math.random().toString().substring(2);r=j.parseAttrs(r);!r.type&&(r.type="text/javascript");j.scripts[v]="<script "+j.serializeAttrs(r)+">"+w+"<\/script>";return"<!-- ELRTE_SCRIPT:"+(v)+" -->"}).replace(this.yMapsRegExp,function(u,r){r=j.parseAttrs(r);r["class"]["elrte-yandex-maps"]="elrte-yandex-maps";r["class"]["elrte-protected"]="elrte-protected";return"<div "+j.serializeAttrs(r)+">"}).replace(this.gMapsRegExp,function(v,u){var x="gmaps"+Math.random().toString().substring(2),r,z;
u=j.parseAttrs(u);r=parseInt(u.width||u.style.width||100);z=parseInt(u.height||u.style.height||100);j.scripts[x]=v;return'<img src="'+j.url+'pixel.gif" class="elrte-google-maps elrte-protected" id="'+x+'" style="width:'+r+"px;height:"+z+'px">'}).replace(this.objRegExp,function(u,r,z){var x=z.match(j.embRegExp),w={obj:j.parseAttrs(r),embed:x&&x.length?j.parseAttrs(x[0].substring(7)):null,params:[]},v=j.rte.utils.mediaInfo(w.embed?w.embed.type||"":"",w.obj.classid||"");if(v){if((x=z.match(j.paramRegExp))){a.each(x,function(t,A){w.params.push(j.parseAttrs(A.substring(6)))
})}!w.obj.classid&&(w.obj.classid=v.classid[0]);!w.obj.codebase&&(w.obj.codebase=v.codebase);w.embed&&!w.embed.type&&(w.embed.type=v.type);w.obj.width=="1"&&delete w.obj.width;w.obj.height=="1"&&delete w.obj.height;if(w.embed){w.embed.width=="1"&&delete w.embed.width;w.embed.height=="1"&&delete w.embed.height}return b(w,v.type)}return u}).replace(this.embRegExp,function(v,r,u){var u=j.parseAttrs(u),w=j.rte.utils.mediaInfo(u.type||"");u.width=="1"&&delete u.width;u.height=="1"&&delete u.height;return w?b({embed:u},w.type):v
}).replace(this.iframeRegExp,function(v,u){var u=j.parseAttrs(u);var r=u.style.width||(parseInt(u.width)>1?parseInt(u.width)+"px":"100px");var A=u.style.height||(parseInt(u.height)>1?parseInt(u.height)+"px":"100px");var z="iframe"+Math.random().toString().substring(2);j.scripts[z]=v;var x='<img id="'+z+'" src="'+j.url+'pixel.gif" class="elrte-protected elrte-iframe" style="width:'+r+"; height:"+A+'">';return x}).replace(this.vimeoRegExp,function(v,r,u){u=j.parseAttrs(u);delete u.frameborder;u.width=="1"&&delete u.width;
u.height=="1"&&delete u.height;u.type="application/x-shockwave-flash";return b({embed:u},"application/x-shockwave-flash")}).replace(/<\/(embed|param)>/gi,"").replace(this.pbRegExp,function(){return'<img src="'+j.url+'pixel.gif" class="elrte-protected elrte-pagebreak">'});o=a("<div>"+c+"</div>");if(!this.rte.options.allowTextNodes){var g=this.rte.dom,q=[],k=[];if(a.browser.msie){for(var h=0;h<o[0].childNodes.length;h++){q.push(o[0].childNodes[h])}}else{q=Array.prototype.slice.call(o[0].childNodes)
}function p(){if(k.length&&g.filter(k,"notEmpty").length){g.wrap(k,document.createElement("p"))}k=[]}a.each(q,function(t,r){if(g.is(r,"block")){p()}else{if(k.length&&r.previousSibling!=k[k.length-1]){p()}k.push(r)}});p()}return o.html()},restore:function(f){var b=this,c=this.rte.options.restore||[];if(c.length){a.each(c,function(g,h){if(typeof(h)=="function"){f=h.call(b,f)}})}f=f.replace(/\<\!--\[CDATA\[([\s\S]*?)\]\]--\>/gi,"<![CDATA[$1]]>").replace(/\<\!--\s*ELRTE_SCRIPT\:\s*(script\d+)\s*--\>/gi,function(h,g){if(b.scripts[g]){h=b.scripts[g];
delete b.scripts[g]}return h||""}).replace(/\<\!-- ELRTE_COMMENT([\s\S]*?) --\>/gi,"$1").replace(this.serviceClassRegExp,function(p,h,k,q){var k=b.parseAttrs(k),g,r="";if(k["class"]["elrte-google-maps"]){var p="";if(b.scripts[k.id]){p=b.scripts[k.id];delete b.scripts[k.id]}return p}else{if(k["class"]["elrte-iframe"]){return b.scripts[k.id]||""}else{if(k["class"]["elrtebm"]){return""}else{if(k["class"]["elrte-media"]){g=b.scripts[k.rel]||{};g.params&&a.each(g.params,function(j,o){r+="<param "+b.serializeAttrs(o)+">\n"
});g.embed&&(r+="<embed "+b.serializeAttrs(g.embed)+">");g.obj&&(r="<object "+b.serializeAttrs(g.obj)+">\n"+r+"\n</object>\n");return r||p}else{if(k["class"]["elrte-pagebreak"]){return"<!-- pagebreak -->"}}}}}a.each(k["class"],function(j){if(/^elrte-\w+/i.test(j)){delete (k["class"][j])}});return"<"+h+" "+b.serializeAttrs(k)+">"+(q||"")});return f},compactStyles:function(c){var b=this;return c.replace(this.tagRegExp,function(h,j,f,g){g=!j&&g?b.serializeAttrs(b.parseAttrs(g),true):"";return"<"+j+f.toLowerCase()+(g?" ":"")+g+">"
})},xhtmlTags:function(b){return this.xhtml?b.replace(/<(img|hr|br|embed|param|link|area)([^>]*\/*)>/gi,"<$1$2 />"):b}};elRTE.prototype.filter.prototype.chains={wysiwyg:["replace","clean","allowedTags","deniedTags","compactStyles"],source:["clean","allowedTags","restore","compactStyles","xhtmlTags"],paste:["clean","allowedTags","cleanPaste","replace","deniedTags","compactStyles"],wysiwyg2wysiwyg:["clean","allowedTags","restore","replace","deniedTags","compactStyles"],source2source:["clean","allowedTags","replace","deniedTags","restore","compactStyles","xhtmlTags"]}
})(jQuery);(function(a){elRTE.prototype.history=function(b){this.rte=b;this._prev=[];this._next=[];this.add=function(){if(this.rte.options.historyLength>0&&this._prev.length>=this.rte.options.historyLength){this._prev.slice(this.rte.options.historyLength)}var c=this.rte.selection.getBookmark();this._prev.push([a(this.rte.doc.body).html(),c]);this.rte.selection.moveToBookmark(c);this._next=[]};this.back=function(){if(this._prev.length){var c=this.rte.selection.getBookmark(),f=this._prev.pop();this._next.push([a(this.rte.doc.body).html(),c]);
a(this.rte.doc.body).html(f[0]);this.rte.selection.moveToBookmark(f[1])}};this.fwd=function(){if(this._next.length){var c=this.rte.selection.getBookmark(),f=this._next.pop();this._prev.push([a(this.rte.doc.body).html(),c]);a(this.rte.doc.body).html(f[0]);this.rte.selection.moveToBookmark(f[1])}};this.canBack=function(){return this._prev.length};this.canFwd=function(){return this._next.length}}})(jQuery);(function(a){elRTE.prototype.options={doctype:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">',cssClass:"el-rte",cssfiles:[],height:null,resizable:true,lang:"en",toolbar:"normal",absoluteURLs:true,allowSource:true,stripWhiteSpace:true,styleWithCSS:false,fmAllow:true,fmOpen:null,allowTags:[],denyTags:["applet","base","basefont","bgsound","blink","body","col","colgroup","isindex","frameset","html","head","meta","marquee","noframes","noembed","o:p","title","xml"],denyAttr:[],pasteDenyAttr:["id","name","class","style","language","onclick","ondblclick","onhover","onkeup","onkeydown","onkeypress"],allowTextNodes:true,allowBrowsersSpecStyles:false,allowPaste:true,pasteOnlyText:false,replace:[],restore:[],pagebreak:'<div style="page-break-after: always;"></div>',buttons:{save:"Save",copy:"Copy",cut:"Cut",css:"Css style and class",paste:"Paste",pastetext:"Paste only text",pasteformattext:"Paste formatted text",removeformat:"Clean format",undo:"Undo last action",redo:"Redo previous action",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyleft:"Align left",justifyright:"Ailgn right",justifycenter:"Align center",justifyfull:"Align full",indent:"Indent",outdent:"Outdent",rtl:"Right to left",ltr:"Left to right",forecolor:"Font color",hilitecolor:"Background color",formatblock:"Format",fontsize:"Font size",fontname:"Font",insertorderedlist:"Ordered list",insertunorderedlist:"Unordered list",horizontalrule:"Horizontal rule",blockquote:"Blockquote",div:"Block element (DIV)",link:"Link",unlink:"Delete link",anchor:"Bookmark",image:"Image",pagebreak:"Page break",smiley:"Smiley",flash:"Flash",table:"Table",tablerm:"Delete table",tableprops:"Table properties",tbcellprops:"Table cell properties",tbrowbefore:"Insert row before",tbrowafter:"Insert row after",tbrowrm:"Delete row",tbcolbefore:"Insert column before",tbcolafter:"Insert column after",tbcolrm:"Delete column",tbcellsmerge:"Merge table cells",tbcellsplit:"Split table cell",docstructure:"Toggle display document structure",elfinder:"Open file manager",fullscreen:"Toggle full screen mode",nbsp:"Non breakable space",stopfloat:"Stop element floating",about:"About this software"},panels:{eol:[],save:["save"],copypaste:["copy","cut","paste","pastetext","pasteformattext","removeformat","docstructure"],undoredo:["undo","redo"],style:["bold","italic","underline","strikethrough","subscript","superscript"],colors:["forecolor","hilitecolor"],alignment:["justifyleft","justifycenter","justifyright","justifyfull"],indent:["outdent","indent"],format:["formatblock","fontsize","fontname"],lists:["insertorderedlist","insertunorderedlist"],elements:["horizontalrule","blockquote","div","stopfloat","css","nbsp","smiley","pagebreak"],direction:["ltr","rtl"],links:["link","unlink","anchor"],images:["image"],media:["image","flash"],tables:["table","tableprops","tablerm","tbrowbefore","tbrowafter","tbrowrm","tbcolbefore","tbcolafter","tbcolrm","tbcellprops","tbcellsmerge","tbcellsplit"],elfinder:["elfinder"],fullscreen:["fullscreen","about"]},toolbars:{tiny:["style"],compact:["save","undoredo","style","alignment","lists","links","fullscreen"],normal:["save","copypaste","undoredo","style","alignment","colors","indent","lists","links","elements","images","fullscreen"],complete:["save","copypaste","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","fullscreen"],maxi:["save","copypaste","undoredo","elfinder","style","alignment","direction","colors","format","indent","lists","links","elements","media","tables","fullscreen"],eldorado:["save","copypaste","elfinder","undoredo","style","alignment","colors","format","indent","lists","links","elements","media","tables","fullscreen"]},panelNames:{save:"Save",copypaste:"Copy/Pase",undoredo:"Undo/Redo",style:"Text styles",colors:"Colors",alignment:"Alignment",indent:"Indent/Outdent",format:"Text format",lists:"Lists",elements:"Misc elements",direction:"Script direction",links:"Links",images:"Images",media:"Media",tables:"Tables",elfinder:"File manager (elFinder)"}}
})(jQuery);(function(a){elRTE.prototype.selection=function(f){this.rte=f;var b=this;this.w3cRange=null;var o,g,c,k;a(this.rte.doc).keyup(function(p){if(p.ctrlKey||p.metaKey||(p.keyCode>=8&&p.keyCode<=13)||(p.keyCode>=32&&p.keyCode<=40)||p.keyCode==46||(p.keyCode>=96&&p.keyCode<=111)){b.cleanCache()}}).mousedown(function(p){if(p.target.nodeName=="HTML"){o=b.rte.doc.body}else{o=p.target}g=c=null}).mouseup(function(p){if(p.target.nodeName=="HTML"){g=b.rte.doc.body}else{g=p.target}g=p.target;c=null}).click();
function j(){return b.rte.window.getSelection?b.rte.window.getSelection():b.rte.window.document.selection}function h(q,t,r){while(q.nodeName!="BODY"&&q.parentNode&&q.parentNode.nodeName!="BODY"&&(t?q!==t&&q.parentNode!=t:1)&&((r=="left"&&b.rte.dom.isFirstNotEmpty(q))||(r=="right"&&b.rte.dom.isLastNotEmpty(q))||(b.rte.dom.isFirstNotEmpty(q)&&b.rte.dom.isLastNotEmpty(q)))){q=q.parentNode}return q}this.collapsed=function(){return this.getRangeAt().isCollapsed()};this.collapse=function(t){var p=j(),q=this.getRangeAt();
q.collapse(t?true:false);if(!a.browser.msie){p.removeAllRanges();p.addRange(q)}return this};this.getRangeAt=function(t){if(this.rte.browser.msie){if(!this.w3cRange){this.w3cRange=new this.rte.w3cRange(this.rte)}t&&this.w3cRange.update();return this.w3cRange}var p=j();var q=p.rangeCount>0?p.getRangeAt(0):this.rte.doc.createRange();q.getStart=function(){return this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(this.startOffset,this.startContainer.childNodes.length-1)]:this.startContainer
};q.getEnd=function(){return this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(this.startOffset==this.endOffset?this.endOffset:this.endOffset-1,this.endContainer.childNodes.length-1)]:this.endContainer};q.isCollapsed=function(){return this.collapsed};return q};this.saveIERange=function(){if(a.browser.msie){k=this.getRangeAt().getBookmark()}};this.restoreIERange=function(){a.browser.msie&&k&&this.getRangeAt().moveToBookmark(k)};this.cloneContents=function(){var p=this.rte.dom.create("div"),t,v,q;
if(a.browser.msie){try{t=this.rte.window.document.selection.createRange()}catch(u){t=this.rte.doc.body.createTextRange()}a(p).html(t.htmlText)}else{v=this.getRangeAt().cloneContents();for(q=0;q<v.childNodes.length;q++){p.appendChild(v.childNodes[q].cloneNode(true))}}return p};this.select=function(t,w){w=w||t;if(this.rte.browser.msie){var u=this.rte.doc.body.createTextRange(),q=u.duplicate(),p=u.duplicate();q.moveToElementText(t);p.moveToElementText(w);u.setEndPoint("StartToStart",q);u.setEndPoint("EndToEnd",p);
u.select()}else{var v=j(),u=this.getRangeAt();u.setStartBefore(t);u.setEndAfter(w);v.removeAllRanges();v.addRange(u)}return this.cleanCache()};this.selectContents=function(p){var t=this.getRangeAt();if(p&&p.nodeType==1){if(this.rte.browser.msie){t.range();t.r.moveToElementText(p.parentNode);t.r.select()}else{try{t.selectNodeContents(p)}catch(u){return this.rte.log("unable select node contents "+p)}var q=j();q.removeAllRanges();q.addRange(t)}}return this};this.deleteContents=function(){if(!a.browser.msie){this.getRangeAt().deleteContents()
}return this};this.insertNode=function(p,u){if(u&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){var v=p.nodeType==3?p.nodeValue:a(this.rte.dom.create("span")).append(a(p)).html();var t=this.getRangeAt();t.insertNode(v)}else{var t=this.getRangeAt();t.insertNode(p);t.setStartAfter(p);t.setEndAfter(p);var q=j();q.removeAllRanges();q.addRange(t)}return this.cleanCache()};this.insertHtml=function(r,q){if(q&&!this.collapsed()){this.collapse()}if(this.rte.browser.msie){this.getRangeAt().range().pasteHTML(r)
}else{var p=a(this.rte.dom.create("span")).html(r||"").get(0).childNodes;while(p.length){this.insertNode(p[0])}}return this.cleanCache()};this.insertText=function(r,q){var p=this.rte.doc.createTextNode(r);return this.insertHtml(p.nodeValue)};this.getBookmark=function(){this.rte.window.focus();var u,q,A,t,z,v=this.rte.dom.createBookmark(),w=this.rte.dom.createBookmark();if(a.browser.msie){try{u=this.rte.window.document.selection.createRange()}catch(w){u=this.rte.doc.body.createTextRange()}if(u.item){var x=u.item(0);
u=this.rte.doc.body.createTextRange();u.moveToElementText(x)}q=u.duplicate();A=u.duplicate();t=this.rte.dom.create("span");z=this.rte.dom.create("span");t.appendChild(v);z.appendChild(w);q.collapse(true);q.pasteHTML(t.innerHTML);A.collapse(false);A.pasteHTML(z.innerHTML)}else{var p=j();var u=p.rangeCount>0?p.getRangeAt(0):this.rte.doc.createRange();q=u.cloneRange();A=u.cloneRange();A.collapse(false);A.insertNode(w);q.collapse(true);q.insertNode(v);this.select(v,w)}return[v.id,w.id]};this.moveToBookmark=function(p){this.rte.window.focus();
if(p&&p.length==2){var q=this.rte.doc.getElementById(p[0]),v=this.rte.doc.getElementById(p[1]),u,t;if(q&&v){this.select(q,v);if(this.rte.dom.next(q)==v){this.collapse(true)}if(!a.browser.msie){u=j();t=u.rangeCount>0?u.getRangeAt(0):this.rte.doc.createRange();u.removeAllRanges();u.addRange(t)}q.parentNode.removeChild(q);v.parentNode.removeChild(v)}}return this};this.removeBookmark=function(p){this.rte.window.focus();if(p.length==2){var q=this.rte.doc.getElementById(p[0]),r=this.rte.doc.getElementById(p[1]);
if(q&&r){q.parentNode.removeChild(q);r.parentNode.removeChild(r)}}};this.cleanCache=function(){o=g=c=null;return this};this.getStart=function(){if(!o){var p=this.getRangeAt();o=p.getStart()}return o};this.getEnd=function(){if(!g){var p=this.getRangeAt();g=p.getEnd()}return g};this.getNode=function(){if(!c){c=this.rte.dom.findCommonAncestor(this.getStart(),this.getEnd())}return c};this.selected=function(B){var w={collapsed:false,blocks:false,filter:false,wrap:"text",tag:"span"};w=a.extend({},w,B);
if(w.blocks){var t=this.getNode(),v=null;if(v=this.rte.dom.selfOrParent(t,"selectionBlock")){return[v]}}var p=this.selectedRaw(w.collapsed,w.blocks);var A=[];var u=[];var q=null;function z(){function D(){for(var F=0;F<u.length;F++){if(u[F].nodeType==1&&(b.rte.dom.selfOrParent(u[F],/^P$/)||a(u[F]).find("p").length>0)){return false}}return true}if(u.length>0){var E=w.tag=="p"&&!D()?"div":w.tag;var C=b.rte.dom.wrap(u,E);A[q]=C;q=null;u=[]}}function x(C){if(C.nodeType==1){if(/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(C.nodeName)){a(C).find("td,th").each(function(){var G=w.tag=="p"&&a(this).find("p").length>0?"div":w.tag;
var F=b.rte.dom.wrapContents(this,G);return A.push(F)})}else{if(/^(CAPTION|TD|TH|LI|DT|DD)$/.test(C.nodeName)){var E=w.tag=="p"&&a(C).find("p").length>0?"div":w.tag;var C=b.rte.dom.wrapContents(C,E);return A.push(C)}}}var D=u.length>0?u[u.length-1]:null;if(D&&D!=b.rte.dom.prev(C)){z()}u.push(C);if(q===null){q=A.length;A.push("dummy")}}if(p.nodes.length>0){for(var r=0;r<p.nodes.length;r++){var t=p.nodes[r];if(t.nodeType==3&&(r==0||r==p.nodes.length-1)&&a.trim(t.nodeValue).length>0){if(r==0&&p.so>0){t=t.splitText(p.so)
}if(r==p.nodes.length-1&&p.eo>0){t.splitText(r==0&&p.so>0?p.eo-p.so:p.eo)}}switch(w.wrap){case"text":if((t.nodeType==1&&t.nodeName=="BR")||(t.nodeType==3&&a.trim(t.nodeValue).length>0)){x(t)}else{if(t.nodeType==1){A.push(t)}}break;case"inline":if(this.rte.dom.isInline(t)){x(t)}else{if(t.nodeType==1){A.push(t)}}break;case"all":if(t.nodeType==1||!this.rte.dom.isEmpty(t)){x(t)}break;default:if(t.nodeType==1||!this.rte.dom.isEmpty(t)){A.push(t)}}}z()}if(A.length){this.rte.window.focus();this.select(A[0],A[A.length-1])
}return w.filter?this.rte.dom.filter(A,w.filter):A};this.dump=function(v,t,w,q,p){var u=this.getRangeAt();this.rte.log("commonAncestorContainer");this.rte.log(v||u.commonAncestorContainer);this.rte.log("startContainer");this.rte.log(t||u.startContainer);this.rte.log("startOffset: "+(q>=0?q:u.startOffset));this.rte.log("endContainer");this.rte.log(w||u.endContainer);this.rte.log("endOffset: "+(p>=0?p:u.endOffset))};this.selectedRaw=function(D,x){var t={so:null,eo:null,nodes:[]};var p=this.getRangeAt(true);
var B=p.commonAncestorContainer;var u,z;var G=false;var H=false;function E(r,I,J){if(r.nodeType==3){J=J>=0?J:r.nodeValue.length;return(I==0&&J==r.nodeValue.length)||a.trim(r.nodeValue).length==a.trim(r.nodeValue.substring(I,J)).length}return true}function q(r,I,J){if(r.nodeType==1){return b.rte.dom.isEmpty(r)}else{if(r.nodeType==3){return a.trim(r.nodeValue.substring(I||0,J>=0?J:r.nodeValue.length)).length==0}}return true}if(p.startContainer.nodeType==1){if(p.startOffset<p.startContainer.childNodes.length){u=p.startContainer.childNodes[p.startOffset];
t.so=u.nodeType==1?null:0}else{u=p.startContainer.childNodes[p.startOffset-1];t.so=u.nodeType==1?null:u.nodeValue.length}}else{u=p.startContainer;t.so=p.startOffset}if(p.collapsed){if(D){if(x){u=h(u);if(!this.rte.dom.isEmpty(u)||(u=this.rte.dom.next(u))){t.nodes=[u]}if(this.rte.dom.isInline(u)){t.nodes=this.rte.dom.toLineStart(u).concat(t.nodes,this.rte.dom.toLineEnd(u))}if(t.nodes.length>0){t.so=t.nodes[0].nodeType==1?null:0;t.eo=t.nodes[t.nodes.length-1].nodeType==1?null:t.nodes[t.nodes.length-1].nodeValue.length
}}else{if(!this.rte.dom.isEmpty(u)){t.nodes=[u]}}}return t}if(p.endContainer.nodeType==1){z=p.endContainer.childNodes[p.endOffset-1];t.eo=z.nodeType==1?null:z.nodeValue.length}else{z=p.endContainer;t.eo=p.endOffset}if(u.nodeType==1||x||E(u,t.so,u.nodeValue.length)){u=h(u,B,"left");G=true;t.so=u.nodeType==1?null:0}if(z.nodeType==1||x||E(z,0,t.eo)){z=h(z,B,"right");H=true;t.eo=z.nodeType==1?null:z.nodeValue.length}if(x){if(u.nodeType!=1&&u.parentNode!=B&&u.parentNode.nodeName!="BODY"){u=u.parentNode;
t.so=null}if(z.nodeType!=1&&z.parentNode!=B&&z.parentNode.nodeName!="BODY"){z=z.parentNode;t.eo=null}}if(u.parentNode==z.parentNode&&u.parentNode.nodeName!="BODY"&&(G&&this.rte.dom.isFirstNotEmpty(u))&&(H&&this.rte.dom.isLastNotEmpty(z))){u=z=u.parentNode;t.so=u.nodeType==1?null:0;t.eo=z.nodeType==1?null:z.nodeValue.length}if(u==z){if(!this.rte.dom.isEmpty(u)){t.nodes.push(u)}return t}var w=u;while(w.nodeName!="BODY"&&w.parentNode!==B&&w.parentNode.nodeName!="BODY"){w=w.parentNode}var F=z;while(F.nodeName!="BODY"&&F.parentNode!==B&&F.parentNode.nodeName!="BODY"){F=F.parentNode
}if(!q(u,t.so,u.nodeType==3?u.nodeValue.length:null)){t.nodes.push(u)}var A=u;while(A!==w){var C=A;while((C=this.rte.dom.next(C))){t.nodes.push(C)}A=A.parentNode}A=w;while((A=this.rte.dom.next(A))&&A!=F){t.nodes.push(A)}var v=[];A=z;while(A!==F){var C=A;while((C=this.rte.dom.prev(C))){v.push(C)}A=A.parentNode}if(v.length){t.nodes=t.nodes.concat(v.reverse())}if(!q(z,0,z.nodeType==3?t.eo:null)){t.nodes.push(z)}if(x){if(this.rte.dom.isInline(u)){t.nodes=this.rte.dom.toLineStart(u).concat(t.nodes);t.so=t.nodes[0].nodeType==1?null:0
}if(this.rte.dom.isInline(z)){t.nodes=t.nodes.concat(this.rte.dom.toLineEnd(z));t.eo=t.nodes[t.nodes.length-1].nodeType==1?null:t.nodes[t.nodes.length-1].nodeValue.length}}return t}}})(jQuery);(function(a){elRTE.prototype.ui=function(v){this.rte=v;this._buttons=[];var k=this,f=this.rte.options.toolbars[v.options.toolbar&&v.options.toolbars[v.options.toolbar]?v.options.toolbar:"normal"],o=f.length,g,r,h,q,u,t,j;for(j in this.buttons){if(this.buttons.hasOwnProperty(j)&&j!="button"){this.buttons[j].prototype=this.buttons.button.prototype
}}while(o--){first=(o==0?true:false);if(f[o-1]=="eol"){first=true}r=f[o];if(r=="eol"){a(this.rte.doc.createElement("br")).prependTo(this.rte.toolbar);continue}g=a('<ul class="panel-'+r+(first?" first":"")+'" />').prependTo(this.rte.toolbar);g.bind("mousedown",function(b){b.preventDefault()});h=this.rte.options.panels[r].length;while(h--){q=this.rte.options.panels[r][h];u=this.buttons[q]||this.buttons.button;this._buttons.push((t=new u(this.rte,q)));g.prepend(t.domElem)}}this.update();this.disable=function(){a.each(k._buttons,function(){!this.active&&this.domElem.addClass("disabled")
})}};elRTE.prototype.ui.prototype.update=function(h){h&&this.rte.selection.cleanCache();var k=this.rte.selection.getNode(),b=this.rte.dom.parents(k,"*"),j=this.rte.rtl,q=j?" &laquo; ":" &raquo; ",o="",c,g;function f(p){var r=p.nodeName.toLowerCase();p=a(p);if(r=="img"){if(p.hasClass("elrte-media")){r="media"}else{if(p.hasClass("elrte-google-maps")){r="google map"}else{if(p.hasClass("elrte-yandex-maps")){r="yandex map"}else{if(p.hasClass("elrte-pagebreak")){r="pagebreak"}}}}}return r}if(k&&k.nodeType==1&&k.nodeName!="BODY"){b.unshift(k)
}if(!j){b=b.reverse()}for(g=0;g<b.length;g++){o+=(g>0?q:"")+f(b[g])}this.rte.statusbar.html(o);a.each(this._buttons,function(){this.update()});this.rte.window.focus()};elRTE.prototype.ui.prototype.buttons={button:function(f,c){var b=this;this.rte=f;this.active=false;this.name=c;this.val=null;this.domElem=a('<li style="-moz-user-select:-moz-none" class="'+c+' rounded-3" name="'+c+'" title="'+this.rte.i18n(this.rte.options.buttons[c]||c)+'" unselectable="on" />').hover(function(){a(this).addClass("hover")
},function(){a(this).removeClass("hover")}).click(function(g){g.stopPropagation();g.preventDefault();if(!a(this).hasClass("disabled")){b.command()}b.rte.window.focus()})}};elRTE.prototype.ui.prototype.buttons.button.prototype.command=function(){this.rte.history.add();try{this.rte.doc.execCommand(this.name,false,this.val)}catch(b){return this.rte.log("commands failed: "+this.name)}this.rte.ui.update(true)};elRTE.prototype.ui.prototype.buttons.button.prototype.update=function(){try{if(!this.rte.doc.queryCommandEnabled(this.name)){return this.domElem.addClass("disabled")
}else{this.domElem.removeClass("disabled")}}catch(b){return}try{if(this.rte.doc.queryCommandState(this.name)){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}catch(b){}}})(jQuery);(function(a){elRTE.prototype.utils=function(c){this.rte=c;this.url=null;this.reg=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;this.baseURL="";this.path="";
this.entities={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};this.entitiesRegExp=/[<>&\"]/g;this.media=[{type:"application/x-shockwave-flash",classid:["clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"},{type:"application/x-director",classid:["clsid:166b1bca-3f9c-11cf-8075-444553540000"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/director/sw.cab#version=8,5,1,0"},{type:"application/x-mplayer2",classid:["clsid:6bf52a52-394a-11d3-b153-00c04f79faa6","clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95","clsid:05589fa1-c356-11ce-bf01-00aa0055595a"],codebase:"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701"},{type:"video/quicktime",classid:["clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b"],codebase:"http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"},{type:"audio/x-pn-realaudio-plugin",classid:["clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa"],codebase:"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"}];
this.rgbRegExp=/\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*/i;this.colorsRegExp=/aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|rgb\s*\([^\)]+\)/i;this.colors={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#fffffff",yellow:"#ffff00"};
var b=this;this.rgb2hex=function(f){return this.color2Hex(""+f)};this.toPixels=function(h){var g=h.match(/([0-9]+\.?[0-9]*)\s*(px|pt|em|%)/);if(g){h=g[1];unit=g[2]}if(h[0]=="."){h="0"+h}h=parseFloat(h);if(isNaN(h)){return""}var f=parseInt(a(document.body).css("font-size"))||16;switch(unit){case"em":return parseInt(h*f);case"pt":return parseInt(h*f/12);case"%":return parseInt(h*f/100)}return h};this.absoluteURL=function(f){!this.url&&this._url();f=a.trim(f);if(!f){return""}if(f[0]=="#"){return f}var g=this.parseURL(f);
if(!g.host&&!g.path&&!g.anchor){return""}if(!this.rte.options.absoluteURLs){return f}if(g.protocol){return f}if(g.host&&(g.host.indexOf(".")!=-1||g.host=="localhost")){return this.url.protocol+"://"+f}if(f[0]=="/"){f=this.baseURL+f}else{if(f.indexOf("./")==0){f=f.substring(2)}f=this.baseURL+this.path+f}return f};this.parseURL=function(f){var h=f.match(this.reg);var g={};a.each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(j){g[this]=h[j]
});if(!g.host.match(/[a-z0-9]/i)){g.host=""}return g};this.trimEventCallback=function(f){f=f?f.toString():"";return a.trim(f.replace(/\r*\n/mg,"").replace(/^function\s*on[a-z]+\s*\(\s*event\s*\)\s*\{(.+)\}$/igm,"$1"))};this._url=function(){this.url=this.parseURL(window.location.href);this.baseURL=this.url.protocol+"://"+(this.url.userInfo?parts.userInfo+"@":"")+this.url.host+(this.url.port?":"+this.url.port:"");this.path=!this.url.file?this.url.path:this.url.path.substring(0,this.url.path.length-this.url.file.length)
};this.makeObject=function(g){var f={};a.each(g,function(h,j){f[j]=j});return f};this.encode=function(f){var g=this.entities;return(""+f).replace(this.entitiesRegExp,function(h){return g[h]})};this.decode=function(f){return a("<div/>").html(f||"").text()};this.parseStyle=function(k){var q={},j=this.rte.options.allowBrowsersSpecStyles,h,g,f,o;if(typeof(k)=="string"&&k.length){a.each(k.replace(/&quot;/gi,"'").split(";"),function(r,p){if((o=p.indexOf(":"))!==-1){g=a.trim(p.substr(0,o));f=a.trim(p.substr(o+1));
if(g=="color"||g=="background-color"){f=f.toLowerCase()}if(g&&f&&(j||g.substring(0,1)!="-")){q[g]=f}}})}return q};this.compactStyle=function(g){var f=this;if(g.border=="medium none"){delete g.border}a.each(g,function(j,h){if(/color$/i.test(j)){g[j]=f.color2Hex(h)}else{if(/^(border|background)$/i.test(j)){g[j]=h.replace(f.colorsRegExp,function(k){return f.color2Hex(k)})}}});if(g["border-width"]){g.border=g["border-width"]+" "+(g["border-style"]||"solid")+" "+(g["border-color"]||"#000");delete g["border-width"];
delete g["border-style"];delete g["border-color"]}if(g["background-image"]){g.background=(g["background-color"]+" ")||""+g["background-image"]+" "+g["background-position"]||"0 0 "+g["background-repeat"]||"repeat";delete g["background-image"];delete ["background-image"];delete ["background-position"];delete ["background-repeat"]}if(g["margin-top"]&&g["margin-right"]&&g["margin-bottom"]&&g["margin-left"]){g.margin=g["margin-top"]+" "+g["margin-right"]+" "+g["margin-bottom"]+" "+g["margin-left"];delete g["margin-top"];
delete g["margin-right"];delete g["margin-bottom"];delete g["margin-left"]}if(g["padding-top"]&&g["padding-right"]&&g["padding-bottom"]&&g["padding-left"]){g.padding=g["padding-top"]+" "+g["padding-right"]+" "+g["padding-bottom"]+" "+g["padding-left"];delete g["padding-top"];delete g["padding-right"];delete g["padding-bottom"];delete g["padding-left"]}if(g["list-style-type"]||g["list-style-position"]||g["list-style-image"]){g["list-style"]=a.trim(g["list-style-type"]||" "+g["list-style-position"]||""+g["list-style-image"]||"");
delete g["list-style-type"];delete g["list-style-position"];delete g["list-style-image"]}return g};this.serializeStyle=function(g,h){var f=[];a.each(h?this.compactStyle(g):g,function(k,j){j&&f.push(k+":"+j)});return f.join(";")};this.parseClass=function(f){f=a.trim(f);return f.length?this.makeObject(f.split(/\s+/)):{};return f.length?f.split(/\s+/):[]};this.serializeClass=function(h){var f=[];var g=this.rte;a.each(h,function(j){f.push(j)});return f.join(" ")};this.mediaInfo=function(g,h){var f=this.media.length;
while(f--){if(g===this.media[f].type||(h&&a.inArray(h,this.media[f].classid)!=-1)){return this.media[f]}}};this.color2Hex=function(h){var g;h=h||"";if(h.indexOf("#")===0){return h}function f(j){j=parseInt(j).toString(16);return j.length>1?j:"0"+j}if(this.colors[h]){return this.colors[h]}if((g=h.match(this.rgbRegExp))){return"#"+f(g[1])+f(g[2])+f(g[3])}return""}}})(jQuery);(function(a){elRTE.prototype.w3cRange=function(c){var b=this;this.rte=c;this.r=null;this.collapsed=true;this.startContainer=null;
this.endContainer=null;this.startOffset=0;this.endOffset=0;this.commonAncestorContainer=null;this.range=function(){try{this.r=this.rte.window.document.selection.createRange()}catch(f){this.r=this.rte.doc.body.createTextRange()}return this.r};this.insertNode=function(g){this.range();b.r.collapse(false);var f=b.r.duplicate();f.pasteHTML(g)};this.getBookmark=function(){this.range();if(this.r.item){var f=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(f)}return this.r.getBookmark()
};this.moveToBookmark=function(f){this.rte.window.focus();this.range().moveToBookmark(f);this.r.select()};this.update=function(){function f(x){var q="\uFEFF";var t=offset=0;var v=b.r.duplicate();v.collapse(x);var w=v.parentElement();if(!w||w.nodeName=="HTML"){return{parent:b.rte.doc.body,ndx:t,offset:offset}}v.pasteHTML(q);childs=w.childNodes;for(var u=0;u<childs.length;u++){var k=childs[u];if(u>0&&(k.nodeType!==3||childs[u-1].nodeType!==3)){t++}if(k.nodeType!==3){offset=0}else{var o=k.nodeValue.indexOf(q);
if(o!==-1){offset+=o;break}offset+=k.nodeValue.length}}v.moveStart("character",-1);v.text="";return{parent:w,ndx:Math.min(t,w.childNodes.length-1),offset:offset}}this.range();this.startContainer=this.endContainer=null;if(this.r.item){this.collapsed=false;var g=this.r.item(0);this.setStart(g.parentNode,this.rte.dom.indexOf(g));this.setEnd(g.parentNode,this.startOffset+1)}else{this.collapsed=this.r.boundingWidth==0;var j=f(true);var h=f(false);j.parent.normalize();h.parent.normalize();j.ndx=Math.min(j.ndx,j.parent.childNodes.length-1);
h.ndx=Math.min(h.ndx,h.parent.childNodes.length-1);if(j.parent.childNodes[j.ndx].nodeType&&j.parent.childNodes[j.ndx].nodeType==1){this.setStart(j.parent,j.ndx)}else{this.setStart(j.parent.childNodes[j.ndx],j.offset)}if(h.parent.childNodes[h.ndx].nodeType&&h.parent.childNodes[h.ndx].nodeType==1){this.setEnd(h.parent,h.ndx)}else{this.setEnd(h.parent.childNodes[h.ndx],h.offset)}this.select()}return this};this.isCollapsed=function(){this.range();this.collapsed=this.r.item?false:this.r.boundingWidth==0;
return this.collapsed};this.collapse=function(g){this.range();if(this.r.item){var f=this.r.item(0);this.r=this.rte.doc.body.createTextRange();this.r.moveToElementText(f)}this.r.collapse(g);this.r.select();this.collapsed=true};this.getStart=function(){this.range();if(this.r.item){return this.r.item(0)}var g=this.r.duplicate();g.collapse(true);var f=g.parentElement();return f&&f.nodeName=="BODY"?(f.firstChild?f.firstChild:f.parentNode.parentNode):f};this.getEnd=function(){this.range();if(this.r.item){return this.r.item(0)
}var f=this.r.duplicate();f.collapse(false);var g=f.parentElement();return g&&g.nodeName=="BODY"?(g.lastChild?g.lastChild:g.parentNode.parentNode):g};this.setStart=function(f,g){this.startContainer=f;this.startOffset=g;if(this.endContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)}};this.setEnd=function(f,g){this.endContainer=f;this.endOffset=g;if(this.startContainer){this.commonAncestorContainer=this.rte.dom.findCommonAncestor(this.startContainer,this.endContainer)
}};this.setStartBefore=function(f){if(f.parentNode){this.setStart(f.parentNode,this.rte.dom.indexOf(f))}};this.setStartAfter=function(f){if(f.parentNode){this.setStart(f.parentNode,this.rte.dom.indexOf(f)+1)}};this.setEndBefore=function(f){if(f.parentNode){this.setEnd(f.parentNode,this.rte.dom.indexOf(f))}};this.setEndAfter=function(f){if(f.parentNode){this.setEnd(f.parentNode,this.rte.dom.indexOf(f)+1)}};this.select=function(){function k(v,z){if(v.nodeType!=3){return -1}var B="\uFEFF";var A=v.nodeValue;
var w=b.rte.doc.body.createTextRange();v.nodeValue=A.substring(0,z)+B+A.substring(z);w.moveToElementText(v.parentNode);w.findText(B);var x=Math.abs(w.moveStart("character",-1048575));v.nodeValue=A;return x}this.r=this.rte.doc.body.createTextRange();var g=this.startOffset;var t=this.endOffset;var j=this.startContainer.nodeType==1?this.startContainer.childNodes[Math.min(g,this.startContainer.childNodes.length-1)]:this.startContainer;var q=this.endContainer.nodeType==1?this.endContainer.childNodes[Math.min(g==t?t:t-1,this.endContainer.childNodes.length-1)]:this.endContainer;
if(this.collapsed){if(j.nodeType==3){var f=k(j,g);this.r.move("character",f)}else{this.r.moveToElementText(j);this.r.collapse(true)}}else{var h=this.rte.doc.body.createTextRange();var o=k(j,g);var u=k(q,t);if(j.nodeType==3){this.r.move("character",o)}else{this.r.moveToElementText(j)}if(q.nodeType==3){h.move("character",u)}else{h.moveToElementText(q)}this.r.setEndPoint("EndToEnd",h)}try{this.r.select()}catch(q){}if(h){h=null}};this.dump=function(){this.rte.log("collapsed: "+this.collapsed);this.rte.log("startContainer: "+(this.startContainer?this.startContainer.nodeName:"non"));
this.rte.log("startOffset: "+this.startOffset);this.rte.log("endContainer: "+(this.endContainer?this.endContainer.nodeName:"none"));this.rte.log("endOffset: "+this.endOffset)}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.about=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.active=true;this.command=function(){var h,f,g;h={rtl:c.rtl,submit:function(k,j){j.close()},dialog:{width:560,title:this.rte.i18n("About this software"),buttons:{Ok:function(){a(this).dialog("destroy")
}}}};g='<div class="elrte-logo"></div><h3>'+this.rte.i18n("About elRTE")+'</h3><br clear="all"/><div class="elrte-ver">'+this.rte.i18n("Version")+": "+this.rte.version+" ("+this.rte.build+')</div><div class="elrte-ver">jQuery: '+a("<div/>").jquery+'</div><div class="elrte-ver">jQueryUI: '+a.ui.version+'</div><div class="elrte-ver">'+this.rte.i18n("Licence")+": BSD Licence</div><p>"+this.rte.i18n("elRTE is an open-source JavaScript based WYSIWYG HTML-editor.")+"<br/>"+this.rte.i18n("Main goal of the editor - simplify work with text and formating (HTML) on sites, blogs, forums and other online services.")+"<br/>"+this.rte.i18n("You can use it in any commercial or non-commercial projects.")+"</p><h4>"+this.rte.i18n("Authors")+'</h4><table class="elrte-authors"><tr><td>Dmitry (dio) Levashov &lt;dio@std42.ru&gt;</td><td>'+this.rte.i18n("Chief developer")+"</td></tr><tr><td>Troex Nevelin &lt;troex@fury.scancode.ru&gt;</td><td>"+this.rte.i18n("Developer, tech support")+"</td></tr><tr><td>Valentin Razumnyh &lt;content@std42.ru&gt;</td><td>"+this.rte.i18n("Interface designer")+"</td></tr><tr><td>Tawfek Daghistani &lt;tawfekov@gmail.com&gt;</td><td>"+this.rte.i18n("RTL support")+"</td></tr>"+(this.rte.options.lang!="en"?"<tr><td>"+this.rte.i18n("_translator")+"</td><td>"+this.rte.i18n("_translation")+"</td></tr>":"")+'</table><div class="elrte-copy">Copyright &copy; 2009-2011, <a href="http://www.std42.ru">Studio 42</a></div><div class="elrte-copy">'+this.rte.i18n("For more information about this software visit the")+' <a href="http://elrte.org">'+this.rte.i18n("elRTE website")+'.</a></div><div class="elrte-copy">Twitter: <a href="http://twitter.com/elrte_elfinder">elrte_elfinder</a></div>';
f=new elDialogForm(h);f.append(g);f.open()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.anchor=function(f,c){this.constructor.prototype.constructor.call(this,f,c);this.input=a('<input type="text" />').attr("name","anchor").attr("size","16");var b=this;this.command=function(){var h={rtl:this.rte.rtl,submit:function(k,j){k.stopPropagation();k.preventDefault();j.close();b.set()},dialog:{title:this.rte.i18n("Bookmark")}};this.anchor=this.rte.dom.selfOrParentAnchor(this.rte.selection.getEnd())||f.dom.create("a");
!this.rte.selection.collapsed()&&this.rte.selection.collapse(false);this.input.val(a(this.anchor).addClass("elrte-anchor").attr("name"));this.rte.selection.saveIERange();var g=new elDialogForm(h);g.append([this.rte.i18n("Bookmark name"),this.input],null,true).open();setTimeout(function(){b.input.focus()},20)};this.update=function(){var g=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(g)){this.domElem.addClass("disabled")}else{if(this.rte.dom.selfOrParentAnchor(g)){this.domElem.removeClass("disabled").addClass("active")
}else{this.domElem.removeClass("disabled").removeClass("active")}}};this.set=function(){var g=a.trim(this.input.val());if(g){this.rte.history.add();if(!this.anchor.parentNode){this.rte.selection.insertHtml('<a name="'+g+'" title="'+this.rte.i18n("Bookmark")+": "+g+'" class="elrte-anchor"></a>')}else{this.anchor.name=g;this.anchor.title=this.rte.i18n("Bookmark")+": "+g}}else{if(this.anchor.parentNode){this.rte.history.add();this.anchor.parentNode.removeChild(this.anchor)}}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.blockquote=function(c,b){this.constructor.prototype.constructor.call(this,c,b);
this.command=function(){var f,g;this.rte.history.add();if(this.rte.selection.collapsed()&&(f=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/))){a(f).replaceWith(a(f).html())}else{g=this.rte.selection.selected({wrap:"all",tag:"blockquote"});g.length&&this.rte.selection.select(g[0],g[g.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^BLOCKQUOTE$/)){this.domElem.removeClass("disabled").addClass("active")
}else{this.domElem.addClass("disabled").removeClass("active")}}else{this.domElem.removeClass("disabled active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.copy=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){if(this.rte.browser.mozilla){try{this.rte.doc.execCommand(this.name,false,null)}catch(j){var g=" Ctl + C";if(this.name=="cut"){g=" Ctl + X"}else{if(this.name=="paste"){g=" Ctl + V"}}var h={dialog:{title:this.rte.i18n("Warning"),buttons:{Ok:function(){a(this).dialog("close")
}}}};var f=new elDialogForm(h);f.append(this.rte.i18n("This operation is disabled in your browser on security reason. Use shortcut instead.")+": "+g).open()}}else{this.constructor.prototype.command.call(this)}}};elRTE.prototype.ui.prototype.buttons.cut=elRTE.prototype.ui.prototype.buttons.copy;elRTE.prototype.ui.prototype.buttons.paste=elRTE.prototype.ui.prototype.buttons.copy})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.css=function(f,c){var b=this;this.constructor.prototype.constructor.call(this,f,c);
this.cssStyle=a('<input type="text" size="42" name="style" />');this.cssClass=a('<input type="text" size="42" name="class" />');this.elementID=a('<input type="text" size="42" name="id" />');this.command=function(){var h=this.node(),j;this.rte.selection.saveIERange();if(h){var j={submit:function(o,k){o.stopPropagation();o.preventDefault();k.close();b.set()},dialog:{title:this.rte.i18n("Style"),width:450,resizable:true,modal:true}};this.cssStyle.val(a(h).attr("style"));this.cssClass.val(a(h).attr("class"));
this.elementID.val(a(h).attr("id"));var g=new elDialogForm(j);g.append([this.rte.i18n("Css style"),this.cssStyle],null,true);g.append([this.rte.i18n("Css class"),this.cssClass],null,true);g.append([this.rte.i18n("ID"),this.elementID],null,true);g.open();setTimeout(function(){b.cssStyle.focus()},20)}};this.set=function(){var g=this.node();this.rte.selection.restoreIERange();if(g){a(g).attr("style",this.cssStyle.val());a(g).attr("class",this.cssClass.val());a(g).attr("id",this.elementID.val());this.rte.ui.update()
}};this.node=function(){var g=this.rte.selection.getNode();if(g.nodeType==3){g=g.parentNode}return g.nodeType==1&&g.nodeName!="BODY"?g:null};this.update=function(){this.domElem.toggleClass("disabled",this.node()?false:true)}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.rtl=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.command=function(){var g=this.rte.selection.getNode(),h=this;if(a(g).attr("dir")=="rtl"||a(g).parents('[dir="rtl"]').length||a(g).find('[dir="rtl"]').length){a(g).removeAttr("dir");
a(g).parents('[dir="rtl"]').removeAttr("dir");a(g).find('[dir="rtl"]').removeAttr("dir")}else{if(this.rte.dom.is(g,"textNodes")&&this.rte.dom.is(g,"block")){a(g).attr("dir","rtl")}else{a.each(this.rte.dom.parents(g,"textNodes"),function(k,j){if(h.rte.dom.is(j,"block")){a(j).attr("dir","rtl");return false}})}}this.rte.ui.update()};this.update=function(){var g=this.rte.selection.getNode();this.domElem.removeClass("disabled");if(a(g).attr("dir")=="rtl"||a(g).parents('[dir="rtl"]').length||a(g).find('[dir="rtl"]').length){this.domElem.addClass("active")
}else{this.domElem.removeClass("active")}}};elRTE.prototype.ui.prototype.buttons.ltr=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.command=function(){var g=this.rte.selection.getNode(),h=this;if(a(g).attr("dir")=="ltr"||a(g).parents('[dir="ltr"]').length||a(g).find('[dir="ltr"]').length){a(g).removeAttr("dir");a(g).parents('[dir="ltr"]').removeAttr("dir");a(g).find('[dir="ltr"]').removeAttr("dir")}else{if(this.rte.dom.is(g,"textNodes")&&this.rte.dom.is(g,"block")){a(g).attr("dir","ltr")
}else{a.each(this.rte.dom.parents(g,"textNodes"),function(k,j){if(h.rte.dom.is(j,"block")){a(j).attr("dir","ltr");return false}})}}this.rte.ui.update()};this.update=function(){var g=this.rte.selection.getNode();this.domElem.removeClass("disabled");if(a(g).attr("dir")=="ltr"||a(g).parents('[dir="ltr"]').length||a(g).find('[dir="ltr"]').length){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.div=function(c,b){this.constructor.prototype.constructor.call(this,c,b);
this.command=function(){var f,g;this.rte.history.add();if(this.rte.selection.collapsed()){f=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/);if(f){a(f).replaceWith(a(f).html())}}else{g=this.rte.selection.selected({wrap:"all",tag:"div"});g.length&&this.rte.selection.select(g[0],g[g.length-1])}this.rte.ui.update(true)};this.update=function(){if(this.rte.selection.collapsed()){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^DIV$/)){this.domElem.removeClass("disabled").addClass("active")
}else{this.domElem.addClass("disabled active")}}else{this.domElem.removeClass("disabled active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.docstructure=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){this.domElem.toggleClass("active");a(this.rte.doc.body).toggleClass("el-rte-structure")};this.command();this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.elfinder=function(f,c){this.constructor.prototype.constructor.call(this,f,c);
var b=this,f=this.rte;this.command=function(){if(b.rte.options.fmAllow&&typeof(b.rte.options.fmOpen)=="function"){b.rte.options.fmOpen(function(g){var h=decodeURIComponent(g.split("/").pop().replace(/\+/g," "));if(f.selection.collapsed()){f.selection.insertHtml('<a href="'+g+'" >'+h+"</a>")}else{f.doc.execCommand("createLink",false,g)}})}};this.update=function(){if(b.rte.options.fmAllow&&typeof(b.rte.options.fmOpen)=="function"){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")
}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.flash=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.swf=null;this.placeholder=null;this.src={url:a('<input type="text" name="url" />').css("width","99%"),type:a('<select name="type"/>').append('<option value="application/x-shockwave-flash">Flash</option>').append('<option value="video/quicktime">Quicktime movie</option>').append('<option value="application/x-mplayer2">Windows media</option>'),width:a('<input type="text" />').attr("size",5).css("text-align","right"),height:a('<input type="text" />').attr("size",5).css("text-align","right"),wmode:a("<select />").append(a("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(a("<option />").val("transparent").text(this.rte.i18n("Transparent"))),align:a("<select />").append(a("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(a("<option />").val("left").text(this.rte.i18n("Left"))).append(a("<option />").val("right").text(this.rte.i18n("Right"))).append(a("<option />").val("top").text(this.rte.i18n("Top"))).append(a("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(a("<option />").val("middle").text(this.rte.i18n("middle"))).append(a("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(a("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(a("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))),margin:a("<div />")};
this.command=function(){var u=this.rte.selection.getEnd(),v,j="",t="",r="",C,k,z,A,B,p;this.rte.selection.saveIERange();this.src.margin.elPaddingInput({type:"margin"});this.placeholder=null;this.swf=null;if(a(u).hasClass("elrte-media")&&(A=a(u).attr("rel"))&&this.rte.filter.scripts[A]){this.placeholder=a(u);B=this.rte.filter.scripts[A];j="";if(B.embed&&B.embed.src){j=B.embed.src}if(B.params&&B.params.length){l=B.params.length;while(l--){if(B.params[l].name=="src"||B.params[l].name=="movie"){j=B.params[l].value
}}}if(B.embed){t=B.embed.width||parseInt(B.embed.style.width)||"";r=B.embed.height||parseInt(B.embed.style.height)||"";p=B.embed.wmode||""}else{if(B.obj){t=B.obj.width||parseInt(B.obj.style.width)||"";r=B.obj.height||parseInt(B.obj.style.height)||"";p=B.obj.wmode||""}}if(B.obj){C=B.obj.style["float"]||"";k=B.obj.style["vertical-align"]||""}else{if(B.embed){C=B.embed.style["float"]||"";k=B.embed.style["vertical-align"]||""}}this.src.margin.val(u);this.src.type.val(B.embed?B.embed.type:"")}if(a(u).hasClass("elrte-swf-placeholder")){this.placeholder=a(u);
j=a(u).attr("rel");t=parseInt(a(u).css("width"))||"";r=parseInt(a(u).css("height"))||"";C=a(u).css("float");k=a(u).css("vertical-align");this.src.margin.val(u);this.src.wmode.val(a(u).attr("wmode"))}this.src.url.val(j);this.src.width.val(t);this.src.height.val(r);this.src.align.val(C||k);this.src.wmode.val(p);var v={rtl:this.rte.rtl,submit:function(o,h){o.stopPropagation();o.preventDefault();b.set();h.close()},dialog:{width:580,position:"top",title:this.rte.i18n("Flash")}};var z=new elDialogForm(v);
if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var x=a("<span />").append(this.src.url.css("width","85%")).append(a("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",b.rte.i18n("Open file manger")).append(a("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){b.rte.options.fmOpen(function(h){b.src.url.val(h).change()})}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")
}))}else{var x=this.src.url}z.append([this.rte.i18n("URL"),x],null,true);z.append([this.rte.i18n("Type"),this.src.type],null,true);z.append([this.rte.i18n("Size"),a("<span />").append(this.src.width).append(" x ").append(this.src.height).append(" px")],null,true);z.append([this.rte.i18n("Wmode"),this.src.wmode],null,true);z.append([this.rte.i18n("Alignment"),this.src.align],null,true);z.append([this.rte.i18n("Margins"),this.src.margin],null,true);z.open();var q=a("<fieldset />").append(a("<legend />").text(this.rte.i18n("Preview")));
z.append(q,"main");var g=document.createElement("iframe");a(g).attr("src","#").addClass("el-rte-preview").appendTo(q);html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body style="padding:0;margin:0;font-size:9px"> Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin</body></html>';
g.contentWindow.document.open();g.contentWindow.document.write(html);g.contentWindow.document.close();this.frame=g.contentWindow.document;this.preview=a(g.contentWindow.document.body);this.src.type.change(function(){b.src.url.change()});this.src.width.change(function(){if(b.swf){var h=parseInt(a(this).val())||"";a(this).val(h);b.swf.css("width",h);b.swf.children("embed").css("width",h)}else{a(this).val("")}});this.src.height.change(function(){if(b.swf){var o=parseInt(a(this).val())||"";a(this).val(o);
b.swf.css("height",o);b.swf.children("embed").css("height",o)}else{a(this).val("")}});this.src.wmode.change(function(){if(b.swf){var h=a(this).val();if(h){b.swf.attr("wmode",h);b.swf.children("embed").attr("wmode",h)}else{b.swf.removeAttr("wmode");b.swf.children("embed").removeAttr("wmode")}}});this.src.align.change(function(){var h=a(this).val(),o=h=="left"||h=="right";if(b.swf){b.swf.css({"float":o?h:"","vertical-align":o?"":h})}else{a(this).val("")}});this.src.margin.change(function(){if(b.swf){var h=b.src.margin.val();
if(h.css){b.swf.css("margin",h.css)}else{b.swf.css("margin-top",h.top);b.swf.css("margin-right",h.right);b.swf.css("margin-bottom",h.bottom);b.swf.css("margin-left",h.left)}}});this.src.url.change(function(){var h=b.rte.utils.absoluteURL(a(this).val()),o,w;if(h){o=b.rte.utils.mediaInfo(b.src.type.val());if(!o){o=b.rte.util.mediaInfo("application/x-shockwave-flash")}w='<object classid="'+o.classid+'" codebase="'+o.codebase+'"><param name="src" value="'+h+'" /><embed quality="high" src="'+h+'" type="'+o.type+'"></object>';
b.preview.children("object").remove().end().prepend(w);b.swf=b.preview.children("object").eq(0)}else{if(b.swf){b.swf.remove();b.swf=null}}b.src.width.trigger("change");b.src.height.trigger("change");b.src.align.trigger("change")}).trigger("change")};this.set=function(){b.swf=null;var g=this.rte.utils.absoluteURL(this.src.url.val()),r=parseInt(this.src.width.val())||"",q=parseInt(this.src.height.val())||"",p=this.src.wmode.val(),k=this.src.align.val(),C=k=="left"||k=="right"?k:"",z=this.placeholder?this.placeholder.attr("rel"):"",B,v,A,u=this.src.margin.val(),x;
if(!g){if(this.placeholder){this.placeholder.remove();delete this.rte.filter.scripts[z]}}else{i=b.rte.utils.mediaInfo(b.src.type.val());if(!i){i=b.rte.util.mediaInfo("application/x-shockwave-flash")}A=this.rte.filter.videoHostRegExp.test(g)?g.replace(this.rte.filter.videoHostRegExp,"$2"):i.type.replace(/^\w+\/(.+)/,"$1");B={obj:{classid:i.classid[0],codebase:i.codebase,style:{}},params:[{name:"src",value:g}],embed:{src:g,type:i.type,quality:"high",wmode:p,style:{}}};if(r){B.obj.width=r;B.embed.width=r
}if(q){B.obj.height=q;B.embed.height=q}if(C){B.obj.style["float"]=C}else{if(k){B.obj.style["vertical-align"]=k}}if(u.css){x={margin:u.css}}else{x={"margin-top":u.top,"margin-right":u.right,"margin-bottom":u.bottom,"margin-left":u.left}}B.obj.style=a.extend({},B.obj.style,x);if(this.placeholder&&z){v=this.rte.filter.scripts[z]||{};B=a.extend(true,v,B);delete B.obj.style.width;delete B.obj.style.height;delete B.embed.style.width;delete B.embed.style.height;this.rte.filter.scripts[z]=B;this.placeholder.removeAttr("class")
}else{var t="media"+Math.random().toString().substring(2);this.rte.filter.scripts[t]=B;this.placeholder=a(this.rte.dom.create("img")).attr("rel",t).attr("src",this.rte.filter.url+"pixel.gif");var j=true}this.placeholder.attr("title",this.rte.utils.encode(g)).attr("width",r||150).attr("height",q||100).addClass("elrte-protected elrte-media elrte-media-"+A).css(B.obj.style);if(C){this.placeholder.css("float",C).css("vertical-align","")}else{if(k){this.placeholder.css("float","").css("vertical-align",k)
}else{this.placeholder.css("float","").css("vertical-align","")}}if(j){this.rte.window.focus();this.rte.selection.restoreIERange();this.rte.selection.insertNode(this.placeholder.get(0))}}};this.update=function(){this.domElem.removeClass("disabled");var g=this.rte.selection.getNode();this.domElem.toggleClass("active",g&&g.nodeName=="IMG"&&a(g).hasClass("elrte-media"))}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.fontname=function(f,c){this.constructor.prototype.constructor.call(this,f,c);
var b=this;var g={tpl:'<span style="font-family:%val">%label</span>',select:function(h){b.set(h)},src:{"":this.rte.i18n("Font"),"andale mono,sans-serif":"Andale Mono","arial,helvetica,sans-serif":"Arial","arial black,gadget,sans-serif":"Arial Black","book antiqua,palatino,sans-serif":"Book Antiqua","comic sans ms,cursive":"Comic Sans MS","courier new,courier,monospace":"Courier New","georgia,palatino,serif":"Georgia","helvetica,sans-serif":"Helvetica","impact,sans-serif":"Impact","lucida console,monaco,monospace":"Lucida console","lucida sans unicode,lucida grande,sans-serif":"Lucida grande","tahoma,sans-serif":"Tahoma","times new roman,times,serif":"Times New Roman","trebuchet ms,lucida grande,verdana,sans-serif":"Trebuchet MS","verdana,geneva,sans-serif":"Verdana"}};
this.select=this.domElem.elSelect(g);this.command=function(){};this.set=function(j){this.rte.history.add();var h=this.rte.selection.selected({filter:"textContainsNodes"});a.each(h,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?a(this).find("td,th"):a(this);a(this).css("font-family",j).find("[style]").css("font-family","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var j=this.rte.selection.getNode();if(j.nodeType!=1){j=j.parentNode
}var h=a(j).css("font-family");h=h?h.toString().toLowerCase().replace(/,\s+/g,",").replace(/'|"/g,""):"";this.select.val(g.src[h]?h:"")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.fontsize=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;var g={labelTpl:"%label",tpl:'<span style="font-size:%val;line-height:1.2em">%label</span>',select:function(h){b.set(h)},src:{"":this.rte.i18n("Font size"),"xx-small":this.rte.i18n("Small (8pt)"),"x-small":this.rte.i18n("Small (10px)"),small:this.rte.i18n("Small (12pt)"),medium:this.rte.i18n("Normal (14pt)"),large:this.rte.i18n("Large (18pt)"),"x-large":this.rte.i18n("Large (24pt)"),"xx-large":this.rte.i18n("Large (36pt)")}};
this.select=this.domElem.elSelect(g);this.command=function(){};this.set=function(j){this.rte.history.add();var h=this.rte.selection.selected({filter:"textContainsNodes"});a.each(h,function(){$this=/^(THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(this.nodeName)?a(this).find("td,th"):a(this);$this.css("font-size",j).find("[style]").css("font-size","")});this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.selection.getNode();this.select.val((m=this.rte.dom.attr(h,"style").match(/font-size:\s*([^;]+)/i))?m[1]:"")
}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.forecolor=function(f,c){var b=this;this.constructor.prototype.constructor.call(this,f,c);var g={"class":"",palettePosition:"outer",color:this.defaultColor,update:function(h){b.indicator.css("background-color",h)},change:function(h){b.set(h)}};this.defaultColor=this.name=="forecolor"?"#000000":"#ffffff";this.picker=this.domElem.elColorPicker(g);this.indicator=a("<div />").addClass("color-indicator").prependTo(this.domElem);this.command=function(){};
this.set=function(k){if(!this.rte.selection.collapsed()){this.rte.history.add();var j=this.rte.selection.selected({collapse:false,wrap:"text"}),h=this.name=="forecolor"?"color":"background-color";a.each(j,function(){if(/^(THEAD|TBODY|TFOOT|TR)$/.test(this.nodeName)){a(this).find("td,th").each(function(){a(this).css(h,k).find("*").css(h,"")})}else{a(this).css(h,k).find("*").css(h,"")}});this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled");var h=this.rte.selection.getNode();
this.picker.val(this.rte.utils.rgb2hex(a(h.nodeType!=1?h.parentNode:h).css(this.name=="forecolor"?"color":"background-color"))||this.defaultColor)}};elRTE.prototype.ui.prototype.buttons.hilitecolor=elRTE.prototype.ui.prototype.buttons.forecolor})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.formatblock=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var h=this.rte.browser.msie?function(j){b.val=j;b.constructor.prototype.command.call(b)}:function(j){b.ieCommand(j)};
var b=this;var g={labelTpl:"%label",tpls:{"":"%label"},select:function(j){b.formatBlock(j)},src:{span:this.rte.i18n("Format"),h1:this.rte.i18n("Heading 1"),h2:this.rte.i18n("Heading 2"),h3:this.rte.i18n("Heading 3"),h4:this.rte.i18n("Heading 4"),h5:this.rte.i18n("Heading 5"),h6:this.rte.i18n("Heading 6"),p:this.rte.i18n("Paragraph"),address:this.rte.i18n("Address"),pre:this.rte.i18n("Preformatted"),div:this.rte.i18n("Normal (DIV)")}};this.select=this.domElem.elSelect(g);this.command=function(){};
this.formatBlock=function(p){function o(v,z){function x(A){a(A).find("h1,h2,h3,h4,h5,h6,p,address,pre").each(function(){a(this).replaceWith(a(this).html())});return A}if(/^(LI|DT|DD|TD|TH|CAPTION)$/.test(v.nodeName)){!b.rte.dom.isEmpty(v)&&b.rte.dom.wrapContents(x(v),z)}else{if(/^(UL|OL|DL|TABLE)$/.test(v.nodeName)){b.rte.dom.wrap(v,z)}else{!b.rte.dom.isEmpty(v)&&a(x(v)).replaceWith(a(b.rte.dom.create(z)).html(a(v).html()))}}}this.rte.history.add();var t=p.toUpperCase(),k,q,j,u=this.rte.selection.collapsed(),w=this.rte.selection.getBookmark(),r=this.rte.selection.selected({collapsed:true,blocks:true,filter:"textContainsNodes",wrap:"inline",tag:"span"});
l=r.length,s=a(r[0]).prev(),e=a(r[r.length-1]).next();while(l--){q=r[l];j=a(q);if(t=="DIV"||t=="SPAN"){if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(q.nodeName)){j.replaceWith(a(this.rte.dom.create("div")).html(j.html()||""))}}else{if(/^(THEAD|TBODY|TFOOT|TR)$/.test(q.nodeName)){j.find("td,th").each(function(){o(this,t)})}else{if(q.nodeName!=t){o(q,t)}}}}this.rte.selection.moveToBookmark(w);this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");var j=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(H[1-6]|P|ADDRESS|PRE)$/);
this.select.val(j?j.nodeName.toLowerCase():"span")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.fullscreen=function(f,c){var b=this;this.constructor.prototype.constructor.call(this,f,c);this.active=true;this.editor=f.editor;this.wz=f.workzone;this.height=0;this.delta=0;this._class="el-fullscreen";setTimeout(function(){b.height=b.wz.height();b.delta=b.editor.outerHeight()-b.height},50);function g(){b.wz.height(a(window).height()-b.delta);b.rte.updateHeight()}this.command=function(){var r=a(window),q=this.editor,j=q.parents().filter(function(p,h){return !/^(html|body)$/i.test(h.nodeName)&&a(h).css("position")=="relative"
}),A=this.wz,z=this._class,B=q.hasClass(z),C=this.rte,k=this.rte.selection,t=a.browser.mozilla,x,o;function v(){if(t){x=k.getBookmark()}}function u(){if(t){b.wz.children().toggle();b.rte.source.focus();b.wz.children().toggle();k.moveToBookmark(x)}}v();j.css("position",B?"relative":"static");if(B){q.removeClass(z);if(C.options.width>0){C.editor.width(C.options.width)}A.height(this.height);r.unbind("resize",g);this.domElem.removeClass("active")}else{q.addClass(z).removeAttr("style");A.height(r.height()-this.delta).css("width","100%");
r.bind("resize",g);this.domElem.addClass("active")}C.updateHeight();C.resizable(B);u()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.horizontalrule=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.src={width:a('<input type="text" />').attr({name:"width",size:4}).css("text-align","right"),wunit:a("<select />").attr("name","wunit").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")).val("%"),height:a('<input type="text" />').attr({name:"height",size:4}).css("text-align","right"),bg:a("<div />"),border:a("<div />"),"class":a('<input type="text" />').css("width","100%"),style:a('<input type="text" />').css("width","100%")};
this.command=function(){this.src.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});var h=this.rte.selection.getEnd();this.hr=h.nodeName=="HR"?a(h):a(f.doc.createElement("hr")).css({width:"100%",height:"1px"});this.src.border.elBorderSelect({styleHeight:73,value:this.hr});var j=this.hr.css("width")||this.hr.attr("width");this.src.width.val(parseInt(j)||100);this.src.wunit.val(j.indexOf("px")!=-1?"px":"%");this.src.height.val(this.rte.utils.toPixels(this.hr.css("height")||this.hr.attr("height"))||1);
this.src.bg.val(this.rte.utils.color2Hex(this.hr.css("background-color")));this.src["class"].val(this.rte.dom.attr(this.hr,"class"));this.src.style.val(this.rte.dom.attr(this.hr,"style"));var k={rtl:this.rte.rtl,submit:function(p,o){p.stopPropagation();p.preventDefault();b.set();o.close()},dialog:{title:this.rte.i18n("Horizontal rule")}};var g=new elDialogForm(k);g.append([this.rte.i18n("Width"),a("<span />").append(this.src.width).append(this.src.wunit)],null,true).append([this.rte.i18n("Height"),a("<span />").append(this.src.height).append(" px")],null,true).append([this.rte.i18n("Border"),this.src.border],null,true).append([this.rte.i18n("Background"),this.src.bg],null,true).append([this.rte.i18n("Css class"),this.src["class"]],null,true).append([this.rte.i18n("Css style"),this.src.style],null,true).open()
};this.update=function(){this.domElem.removeClass("disabled");if(this.rte.selection.getEnd().nodeName=="HR"){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}};this.set=function(){this.rte.history.add();!this.hr.parentNode&&this.rte.selection.insertNode(this.hr.get(0));var j={noshade:true,style:this.src.style.val()};var h=this.src.border.val();var g={width:(parseInt(this.src.width.val())||100)+this.src.wunit.val(),height:parseInt(this.src.height.val())||1,"background-color":this.src.bg.val(),border:h.width&&h.style?h.width+" "+h.style+" "+h.color:""};
this.hr.removeAttr("class").removeAttr("style").removeAttr("width").removeAttr("height").removeAttr("align").attr(j).css(g);if(this.src["class"].val()){this.hr.attr("class",this.src["class"].val())}this.rte.ui.update()}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.image=function(r,f){this.constructor.prototype.constructor.call(this,r,f);var j=this,r=j.rte,o=0,g=0,q=0,c=null,b=function(t){a.each(j.src,function(u,v){a.each(v,function(w,x){if(w=="src"&&t){return}x.val("")})})},k=function(t){a.each(j.src,function(u,v){a.each(v,function(x,B){var E,z,D,A,C;
if(x=="width"){E=t.width()}else{if(x=="height"){E=t.height()}else{if(x=="border"){E="";C=t.css("border")||r.utils.parseStyle(t.attr("style")).border||"";if(C){z=C.match(/(\d(px|em|%))/);D=C.match(/(#[a-z0-9]+)/);E={width:z?z[1]:C,style:C,color:r.utils.color2Hex(D?D[1]:C)}}}else{if(x=="margin"){E=t}else{if(x=="align"){E=t.css("float");if(E!="left"&&E!="right"){E=t.css("vertical-align")}}else{E=t.attr(x)||""}}}}}if(u=="events"){E=r.utils.trimEventCallback(E)}B.val(E)})})},p=function(){var t=j.src.main.src.val();
b(true);if(!t){j.preview.children("img").remove();j.prevImg=null}else{if(j.prevImg){j.prevImg.removeAttr("src").removeAttr("style").removeAttr("class").removeAttr("id").removeAttr("title").removeAttr("alt").removeAttr("longdesc");a.each(j.src.events,function(u,v){j.prevImg.removeAttr(u)})}else{j.prevImg=a("<img/>").prependTo(j.preview)}j.prevImg.load(function(){j.prevImg.unbind("load");setTimeout(function(){g=j.prevImg.width();q=j.prevImg.height();o=(g/q).toFixed(2);j.src.main.width.val(g);j.src.main.height.val(q)
},100)}).attr("src",t)}},h=function(v){var t=parseInt(j.src.main.width.val())||0,u=parseInt(j.src.main.height.val())||0;if(j.prevImg){if(t&&u){if(v.target===j.src.main.width[0]){u=parseInt(t/o)}else{t=parseInt(u*o)}}else{t=g;u=q}j.src.main.height.val(u);j.src.main.width.val(t);j.prevImg.width(t).height(u);j.src.adv.style.val(j.prevImg.attr("style"))}};this.img=null;this.prevImg=null;this.preview=a('<div class="elrte-image-preview"/>').text("Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin");
this.init=function(){this.labels={main:"Properies",link:"Link",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",longdesc:"Detail description URL",href:"URL",target:"Open in",title:"Title"};this.src={main:{src:a('<input type="text" />').css("width","100%").change(p),title:a('<input type="text" />').css("width","100%"),alt:a('<input type="text" />').css("width","100%"),width:a('<input type="text" />').attr("size",5).css("text-align","right").change(h),height:a('<input type="text" />').attr("size",5).css("text-align","right").change(h),margin:a("<div />").elPaddingInput({type:"margin",change:function(){var t=j.src.main.margin.val();
if(j.prevImg){if(t.css){j.prevImg.css("margin",t.css)}else{j.prevImg.css({"margin-left":t.left,"margin-top":t.top,"margin-right":t.right,"margin-bottom":t.bottom})}}}}),align:a("<select />").css("width","100%").append(a("<option />").val("").text(this.rte.i18n("Not set","dialogs"))).append(a("<option />").val("left").text(this.rte.i18n("Left"))).append(a("<option />").val("right").text(this.rte.i18n("Right"))).append(a("<option />").val("top").text(this.rte.i18n("Top"))).append(a("<option />").val("text-top").text(this.rte.i18n("Text top"))).append(a("<option />").val("middle").text(this.rte.i18n("middle"))).append(a("<option />").val("baseline").text(this.rte.i18n("Baseline"))).append(a("<option />").val("bottom").text(this.rte.i18n("Bottom"))).append(a("<option />").val("text-bottom").text(this.rte.i18n("Text bottom"))).change(function(){var u=a(this).val(),t={"float":"","vertical-align":""};
if(j.prevImg){if(u=="left"||u=="right"){t["float"]=u;t["vertical-align"]=""}else{if(u){t["float"]="";t["vertical-align"]=u}}j.prevImg.css(t)}}),border:a("<div />").elBorderSelect({name:"border",change:function(){var t=j.src.main.border.val();if(j.prevImg){j.prevImg.css("border",t.width?t.width+" "+t.style+" "+t.color:"")}}})},adv:{},events:{}};a.each(["id","class","style","longdesc"],function(u,t){j.src.adv[t]=a('<input type="text" style="width:100%" />')});this.src.adv["class"].change(function(){if(j.prevImg){j.prevImg.attr("class",a(this).val())
}});this.src.adv.style.change(function(){if(j.prevImg){j.prevImg.attr("style",a(this).val());k(j.prevImg)}});a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){j.src.events[this]=a('<input type="text"  style="width:100%"/>')})};this.command=function(){!this.src&&this.init();var w,x={rtl:r.rtl,submit:function(A,z){A.stopPropagation();A.preventDefault();j.set();u.close()},close:function(){c&&r.selection.moveToBookmark(c)
},dialog:{autoOpen:false,width:500,position:"top",title:r.i18n("Image"),resizable:true,open:function(){a.fn.resizable&&a(this).parents(".ui-dialog:first").resizable("option","alsoResize",".elrte-image-preview")}}},u=new elDialogForm(x),t=!!r.options.fmOpen,v=t?a('<div class="elrte-image-src-fm"><span class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-folder-open"></span></span></div>').append(this.src.main.src.css("width","87%")):this.src.main.src;b();this.preview.children("img").remove();
this.prevImg=null;w=r.selection.getEnd();this.img=w.nodeName=="IMG"&&!a(w).is(".elrte-protected")?a(w):a("<img/>");c=r.selection.getBookmark();if(t){v.children(".ui-state-default").click(function(){r.options.fmOpen(function(z){j.src.main.src.val(z).change()})}).hover(function(){a(this).toggleClass("ui-state-hover")})}u.tab("main",this.rte.i18n("Properies")).append([this.rte.i18n("Image URL"),v],"main",true).append([this.rte.i18n("Title"),this.src.main.title],"main",true).append([this.rte.i18n("Alt text"),this.src.main.alt],"main",true).append([this.rte.i18n("Size"),a("<span />").append(this.src.main.width).append(" x ").append(this.src.main.height).append(" px")],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true);
u.append(a("<fieldset><legend>"+this.rte.i18n("Preview")+"</legend></fieldset>").append(this.preview),"main");a.each(this.src,function(z,A){if(z=="main"){return}u.tab(z,r.i18n(j.labels[z]));a.each(A,function(B,C){j.src[z][B].val(z=="events"?r.utils.trimEventCallback(j.img.attr(B)):j.img.attr(B)||"");u.append([r.i18n(j.labels[B]||B),j.src[z][B]],z,true)})});u.open();if(this.img.attr("src")){k(this.img);this.prevImg=this.img.clone().prependTo(this.preview);o=(this.img.width()/this.img.height()).toFixed(2);
g=parseInt(this.img.width());q=parseInt(this.img.height())}};this.set=function(){var t=this.src.main.src.val(),u;this.rte.history.add();c&&r.selection.moveToBookmark(c);if(!t){u=r.dom.selfOrParentLink(this.img[0]);u&&u.remove();return this.img.remove()}!this.img[0].parentNode&&(this.img=a(this.rte.doc.createElement("img")));this.img.attr("src",t).attr("style",this.src.adv.style.val());a.each(this.src,function(v,w){a.each(w,function(x,z){var B=z.val(),A;switch(x){case"width":j.img.css("width",B);break;
case"height":j.img.css("height",B);break;case"align":j.img.css(B=="left"||B=="right"?"float":"vertical-align",B);break;case"margin":if(B.css){j.img.css("margin",B.css)}else{j.img.css({"margin-left":B.left,"margin-top":B.top,"margin-right":B.right,"margin-bottom":B.bottom})}break;case"border":if(!B.width){B=""}else{B="border:"+B.css+";"+a.trim((j.img.attr("style")||"").replace(/border\-[^;]+;?/ig,""));x="style";j.img.attr("style",B);return}break;case"src":case"style":return;default:B?j.img.attr(x,B):j.img.removeAttr(x)
}})});!this.img[0].parentNode&&r.selection.insertNode(this.img[0]);this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");var t=this.rte.selection.getEnd(),u=a(t);if(t.nodeName=="IMG"&&!u.hasClass("elrte-protected")){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.indent=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.command=function(){this.rte.history.add();
var h=this.rte.selection.selected({collapsed:true,blocks:true,wrap:"inline",tag:"p"});function k(o){var p=/(IMG|HR|TABLE|EMBED|OBJECT)/.test(o.nodeName)?"margin-left":"padding-left";var q=b.rte.dom.attr(o,"style").indexOf(p)!=-1?parseInt(a(o).css(p))||0:0;a(o).css(p,q+40+"px")}for(var j=0;j<h.length;j++){if(/^(TABLE|THEAD|TFOOT|TBODY|COL|COLGROUP|TR)$/.test(h[j].nodeName)){a(h[j]).find("td,th").each(function(){k(this)})}else{if(/^LI$/.test(h[j].nodeName)){var g=a(h[j]);a(this.rte.dom.create(h[j].parentNode.nodeName)).append(a(this.rte.dom.create("li")).html(g.html()||"")).appendTo(g.html("&nbsp;"))
}else{k(h[j])}}}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.justifyleft=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.align=this.name=="justifyfull"?"justify":this.name.replace("justify","");this.command=function(){var g=this.rte.selection.selected({collapsed:true,blocks:true,tag:"div"}),f=g.length;f&&this.rte.history.add();while(f--){this.rte.dom.filter(g[f],"textNodes")&&a(g[f]).css("text-align",this.align)
}this.rte.ui.update()};this.update=function(){var g=this.rte.selection.getNode(),f=g.nodeName=="BODY"?g:this.rte.dom.selfOrParent(g,"textNodes")||(g.parentNode&&g.parentNode.nodeName=="BODY"?g.parentNode:null);if(f){this.domElem.removeClass("disabled").toggleClass("active",a(f).css("text-align")==this.align)}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.justifycenter=elRTE.prototype.ui.prototype.buttons.justifyleft;elRTE.prototype.ui.prototype.buttons.justifyright=elRTE.prototype.ui.prototype.buttons.justifyleft;
elRTE.prototype.ui.prototype.buttons.justifyfull=elRTE.prototype.ui.prototype.buttons.justifyleft})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.link=function(g,f){this.constructor.prototype.constructor.call(this,g,f);var b=this;this.img=false;this.bm;function c(){b.labels={id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language",charset:"Charset",type:"Target MIME type",rel:"Relationship page to target (rel)",rev:"Relationship target to page (rev)",tabindex:"Tab index",accesskey:"Access key"};
b.src={main:{href:a('<input type="text" />'),title:a('<input type="text" />'),anchor:a("<select />").attr("name","anchor"),target:a("<select />").append(a("<option />").text(b.rte.i18n("In this window")).val("")).append(a("<option />").text(b.rte.i18n("In new window (_blank)")).val("_blank"))},popup:{use:a('<input type="checkbox" name="use" />'),url:a('<input type="text" />').val("http://"),name:a('<input type="text" />'),width:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Width")}).css("text-align","right"),height:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Height")}).css("text-align","right"),left:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Left")}).css("text-align","right"),top:a('<input type="text" />').attr({size:6,title:b.rte.i18n("Top")}).css("text-align","right"),location:a('<input type="checkbox" />'),menubar:a('<input type="checkbox" />'),toolbar:a('<input type="checkbox" />'),scrollbars:a('<input type="checkbox" />'),status:a('<input type="checkbox" />'),resizable:a('<input type="checkbox" />'),dependent:a('<input type="checkbox" />'),retfalse:a('<input type="checkbox" />').attr("checked",true)},adv:{id:a('<input type="text" />'),"class":a('<input type="text" />'),style:a('<input type="text" />'),dir:a("<select />").append(a("<option />").text(b.rte.i18n("Not set")).val("")).append(a("<option />").text(b.rte.i18n("Left to right")).val("ltr")).append(a("<option />").text(b.rte.i18n("Right to left")).val("rtl")),lang:a('<input type="text" />'),charset:a('<input type="text" />'),type:a('<input type="text" />'),rel:a('<input type="text" />'),rev:a('<input type="text" />'),tabindex:a('<input type="text" />'),accesskey:a('<input type="text" />')},events:{}};
a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />')});a.each(b.src,function(){for(var h in this){var j=this[h].attr("type");if(!j||(j=="text"&&!this[h].attr("size"))){this[h].css("width","100%")}}})}this.command=function(){var t=this.rte.selection.getNode(),j,p,q,w,z,k,u,h,o;!this.src&&c();this.bm=this.rte.selection.getBookmark();function x(r){return r.nodeName=="A"&&r.href
}this.link=this.rte.dom.selfOrParentLink(t);if(!this.link){j=a.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:false});if(j.length){for(p=0;p<j.length;p++){if(x(j[p])){this.link=j[p];break}}if(!this.link){this.link=this.rte.dom.parent(j[0],x)||this.rte.dom.parent(j[j.length-1],x)}}}this.link=this.link?a(this.link):a(this.rte.doc.createElement("a"));this.img=t.nodeName=="IMG"?t:null;this.updatePopup();this.src.main.anchor.empty();a('a[href!=""][name]',this.rte.doc).each(function(){var r=a(this).attr("name");
b.src.main.anchor.append(a("<option />").val(r).text(r))});if(this.src.main.anchor.children().length){this.src.main.anchor.prepend(a("<option />").val("").text(this.rte.i18n("Select bookmark"))).change(function(){var r=a(this).val();if(r){b.src.main.href.val("#"+r)}})}w={rtl:this.rte.rtl,submit:function(v,r){v.stopPropagation();v.preventDefault();b.set();r.close()},tabs:{show:function(v,r){if(r.index==3){b.updateOnclick()}}},close:function(){b.rte.browser.msie&&b.rte.selection.restoreIERange()},dialog:{width:"auto",width:430,title:this.rte.i18n("Link")}};
d=new elDialogForm(w);z=a("<div />").append(a("<label />").append(this.src.popup.location).append(this.rte.i18n("Location bar"))).append(a("<label />").append(this.src.popup.menubar).append(this.rte.i18n("Menu bar"))).append(a("<label />").append(this.src.popup.toolbar).append(this.rte.i18n("Toolbar"))).append(a("<label />").append(this.src.popup.scrollbars).append(this.rte.i18n("Scrollbars")));k=a("<div />").append(a("<label />").append(this.src.popup.status).append(this.rte.i18n("Status bar"))).append(a("<label />").append(this.src.popup.resizable).append(this.rte.i18n("Resizable"))).append(a("<label />").append(this.src.popup.dependent).append(this.rte.i18n("Depedent"))).append(a("<label />").append(this.src.popup.retfalse).append(this.rte.i18n("Add return false")));
d.tab("main",this.rte.i18n("Properies")).tab("popup",this.rte.i18n("Popup")).tab("adv",this.rte.i18n("Advanced")).tab("events",this.rte.i18n("Events")).append(a("<label />").append(this.src.popup.use).append(this.rte.i18n("Open link in popup window")),"popup").separator("popup").append([this.rte.i18n("URL"),this.src.popup.url],"popup",true).append([this.rte.i18n("Window name"),this.src.popup.name],"popup",true).append([this.rte.i18n("Window size"),a("<span />").append(this.src.popup.width).append(" x ").append(this.src.popup.height).append(" px")],"popup",true).append([this.rte.i18n("Window position"),a("<span />").append(this.src.popup.left).append(" x ").append(this.src.popup.top).append(" px")],"popup",true).separator("popup").append([z,k],"popup",true);
u=this.link.get(0);h=this.rte.dom.attr(u,"href");this.src.main.href.val(h).change(function(){a(this).val(b.rte.utils.absoluteURL(a(this).val()))});if(this.rte.options.fmAllow&&this.rte.options.fmOpen){var o=a("<span />").append(this.src.main.href.css("width","87%")).append(a("<span />").addClass("ui-state-default ui-corner-all").css({"float":"right","margin-right":"3px"}).attr("title",b.rte.i18n("Open file manger")).append(a("<span />").addClass("ui-icon ui-icon-folder-open")).click(function(){b.rte.options.fmOpen(function(r){b.src.main.href.val(r).change()
})}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}));d.append([this.rte.i18n("Link URL"),o],"main",true)}else{d.append([this.rte.i18n("Link URL"),this.src.main.href],"main",true)}this.src.main.href.change();d.append([this.rte.i18n("Title"),this.src.main.title.val(this.rte.dom.attr(u,"title"))],"main",true);if(this.src.main.anchor.children().length){d.append([this.rte.i18n("Bookmark"),this.src.main.anchor.val(h)],"main",true)}if(!(this.rte.options.doctype.match(/xhtml/)&&this.rte.options.doctype.match(/strict/))){d.append([this.rte.i18n("Target"),this.src.main.target.val(this.link.attr("target")||"")],"main",true)
}for(var t in this.src.adv){this.src.adv[t].val(this.rte.dom.attr(u,t));d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.adv[t]],"adv",true)}for(var t in this.src.events){var q=this.rte.utils.trimEventCallback(this.rte.dom.attr(u,t));this.src.events[t].val(q);d.append([this.rte.i18n(this.labels[t]?this.labels[t]:t),this.src.events[t]],"events",true)}this.src.popup.use.change(function(){var r=a(this).attr("checked");a.each(b.src.popup,function(){if(a(this).attr("name")!="use"){if(r){a(this).removeAttr("disabled")
}else{a(this).attr("disabled",true)}}})});this.src.popup.use.change();d.open()};this.update=function(){var h=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(h)){this.domElem.removeClass("disabled").addClass("active")}else{if(this.rte.dom.selectionHas(function(j){return j.nodeName=="A"&&j.href})){this.domElem.removeClass("disabled").addClass("active")}else{if(!this.rte.selection.collapsed()||h.nodeName=="IMG"){this.domElem.removeClass("disabled active")}else{this.domElem.addClass("disabled").removeClass("active")
}}}};this.updatePopup=function(){var h=""+this.link.attr("onclick");if(h.length>0&&(m=h.match(/window.open\('([^']+)',\s*'([^']*)',\s*'([^']*)'\s*.*\);\s*(return\s+false)?/))){this.src.popup.use.attr("checked","on");this.src.popup.url.val(m[1]);this.src.popup.name.val(m[2]);if(/location=yes/.test(m[3])){this.src.popup.location.attr("checked",true)}if(/menubar=yes/.test(m[3])){this.src.popup.menubar.attr("checked",true)}if(/toolbar=yes/.test(m[3])){this.src.popup.toolbar.attr("checked",true)}if(/scrollbars=yes/.test(m[3])){this.src.popup.scrollbars.attr("checked",true)
}if(/status=yes/.test(m[3])){this.src.popup.status.attr("checked",true)}if(/resizable=yes/.test(m[3])){this.src.popup.resizable.attr("checked",true)}if(/dependent=yes/.test(m[3])){this.src.popup.dependent.attr("checked",true)}if((_m=m[3].match(/width=([^,]+)/))){this.src.popup.width.val(_m[1])}if((_m=m[3].match(/height=([^,]+)/))){this.src.popup.height.val(_m[1])}if((_m=m[3].match(/left=([^,]+)/))){this.src.popup.left.val(_m[1])}if((_m=m[3].match(/top=([^,]+)/))){this.src.popup.top.val(_m[1])}if(m[4]){this.src.popup.retfalse.attr("checked",true)
}}else{a.each(this.src.popup,function(){var j=a(this);if(j.attr("type")=="text"){j.val(j.attr("name")=="url"?"http://":"")}else{if(j.attr("name")=="retfalse"){this.attr("checked",true)}else{j.removeAttr("checked")}}})}};this.updateOnclick=function(){var k=this.src.popup.url.val();if(this.src.popup.use.attr("checked")&&k){var j="";if(this.src.popup.location.attr("checked")){j+="location=yes,"}if(this.src.popup.menubar.attr("checked")){j+="menubar=yes,"}if(this.src.popup.toolbar.attr("checked")){j+="toolbar=yes,"
}if(this.src.popup.scrollbars.attr("checked")){j+="scrollbars=yes,"}if(this.src.popup.status.attr("checked")){j+="status=yes,"}if(this.src.popup.resizable.attr("checked")){j+="resizable=yes,"}if(this.src.popup.dependent.attr("checked")){j+="dependent=yes,"}if(this.src.popup.width.val()){j+="width="+this.src.popup.width.val()+","}if(this.src.popup.height.val()){j+="height="+this.src.popup.height.val()+","}if(this.src.popup.left.val()){j+="left="+this.src.popup.left.val()+","}if(this.src.popup.top.val()){j+="top="+this.src.popup.top.val()+","
}if(j.length>0){j=j.substring(0,j.length-1)}var p=this.src.popup.retfalse.attr("checked")?"return false;":"";var o="window.open('"+k+"', '"+a.trim(this.src.popup.name.val())+"', '"+j+"'); "+p;this.src.events.onclick.val(o);if(!this.src.main.href.val()){this.src.main.href.val("#")}}else{var h=this.src.events.onclick.val();h=h.replace(/window\.open\([^\)]+\)\s*;?\s*return\s*false\s*;?/i,"");this.src.events.onclick.val(h)}};this.set=function(){var q,o;this.updateOnclick();this.rte.selection.moveToBookmark(this.bm);
this.rte.history.add();q=this.rte.utils.absoluteURL(this.src.main.href.val());if(!q){var p=this.rte.selection.getBookmark();this.rte.dom.unwrap(this.link[0]);this.rte.selection.moveToBookmark(p)}else{if(this.img&&this.img.parentNode){this.link=a(this.rte.dom.create("a")).attr("href",q);this.rte.dom.wrap(this.img,this.link[0])}else{if(!this.link[0].parentNode){o="#--el-editor---"+Math.random();this.rte.doc.execCommand("createLink",false,o);this.link=a('a[href="'+o+'"]',this.rte.doc);this.link.each(function(){var r=a(this);
if(!a.trim(r.html())&&!a.trim(r.text())){r.replaceWith(r.text())}})}}this.src.main.href.val(q);for(var k in this.src){if(k!="popup"){for(var j in this.src[k]){if(j!="anchors"){var h=a.trim(this.src[k][j].val());if(h){this.link.attr(j,h)}else{this.link.removeAttr(j)}}}}}this.img&&this.rte.selection.select(this.img)}this.rte.ui.update(true)}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.nbsp=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){this.rte.history.add();
this.rte.selection.insertHtml("&nbsp;",true);this.rte.window.focus();this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.outdent=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.command=function(){var g=this.find();if(g.node){this.rte.history.add();a(g.node).css(g.type,(g.val>40?g.val-40:0)+"px");this.rte.ui.update()}};this.find=function(g){function j(k){var o={type:"",val:0};
var p;if((p=b.rte.dom.attr(k,"style"))){o.type=p.indexOf("padding-left")!=-1?"padding-left":(p.indexOf("margin-left")!=-1?"margin-left":"");o.val=o.type?parseInt(a(k).css(o.type))||0:0}return o}var g=this.rte.selection.getNode();var h=j(g);if(h.val){h.node=g}else{a.each(this.rte.dom.parents(g,"*"),function(){h=j(this);if(h.val){h.node=this;return h}})}return h};this.update=function(){var g=this.find();if(g.node){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);
(function(a){elRTE.prototype.ui.prototype.buttons.pagebreak=function(c,b){this.constructor.prototype.constructor.call(this,c,b);a(this.rte.doc.body).bind("mousedown",function(f){if(a(f.target).hasClass("elrte-pagebreak")){f.preventDefault()}});this.command=function(){this.rte.selection.insertHtml('<img src="'+this.rte.filter.url+'pixel.gif" class="elrte-protected elrte-pagebreak"/>',false)};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.pasteformattext=function(f,c){this.constructor.prototype.constructor.call(this,f,c);
this.iframe=a(document.createElement("iframe")).addClass("el-rte-paste-input");this.doc=null;var b=this;this.command=function(){this.rte.selection.saveIERange();var h=this,j={submit:function(p,o){p.stopPropagation();p.preventDefault();h.paste();o.close()},dialog:{width:500,title:this.rte.i18n("Paste formatted text")}},g=new elDialogForm(j);g.append(this.iframe).open();this.doc=this.iframe.get(0).contentWindow.document;html=this.rte.options.doctype+'<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';
html+="</head><body> <br /> </body></html>";this.doc.open();this.doc.write(html);this.doc.close();if(!this.rte.browser.msie){try{this.doc.designMode="on"}catch(k){}}else{this.doc.body.contentEditable=true}setTimeout(function(){h.iframe[0].contentWindow.focus()},50)};this.paste=function(){a(this.doc.body).find("[class]").removeAttr("class");var g=a.trim(a(this.doc.body).html());if(g){this.rte.history.add();this.rte.selection.restoreIERange();this.rte.selection.insertHtml(this.rte.filter.wysiwyg2wysiwyg(this.rte.filter.proccess("paste",g)));
this.rte.ui.update(true)}};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.pastetext=function(f,c){this.constructor.prototype.constructor.call(this,f,c);this.input=a("<textarea />").addClass("el-rte-paste-input");var b=this;this.command=function(){this.rte.browser.msie&&this.rte.selection.saveIERange();var h={submit:function(k,j){k.stopPropagation();k.preventDefault();b.paste();j.close()},dialog:{width:500,title:this.rte.i18n("Paste only text")}};
var g=new elDialogForm(h);g.append(this.input).open()};this.paste=function(){var g=a.trim(this.input.val());if(g){this.rte.history.add();this.rte.browser.msie&&this.rte.selection.restoreIERange();this.rte.selection.insertText(g.replace(/\r?\n/g,"<br />"),true);this.rte.ui.update(true)}this.input.val("")};this.update=function(){this.domElem.removeClass("disabled")}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.save=function(c,b){this.constructor.prototype.constructor.call(this,c,b);
this.active=true;this.command=function(){this.rte.save()};this.update=function(){}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.smiley=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.img=null;this.url=this.rte.filter.url+"smileys/";this.smileys={smile:"smile.png",happy:"happy.png",tongue:"tongue.png",surprised:"surprised.png",waii:"waii.png",wink:"wink.png",evilgrin:"evilgrin.png",grin:"grin.png",unhappy:"unhappy.png"};this.width=120;this.command=function(){var j=this,h=this.url,g,o,k;
this.rte.browser.msie&&this.rte.selection.saveIERange();o={dialog:{height:120,width:this.width,title:this.rte.i18n("Smiley"),buttons:{}}};g=new elDialogForm(o);a.each(this.smileys,function(p,q){g.append(a('<img src="'+h+q+'" title="'+p+'" id="'+p+'" class="el-rte-smiley"/>').click(function(){j.set(this.id,g)}))});g.open()};this.update=function(){this.domElem.removeClass("disabled");this.domElem.removeClass("active")};this.set=function(h,g){this.rte.browser.msie&&this.rte.selection.restoreIERange();
if(this.smileys[h]){this.img=a(this.rte.doc.createElement("img"));this.img.attr({src:this.url+this.smileys[h],title:h,alt:h});this.rte.selection.insertNode(this.img.get(0));this.rte.ui.update()}g.close()}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.stopfloat=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.find=function(){if(this.rte.selection.collapsed()){var f=this.rte.dom.selfOrParent(this.rte.selection.getEnd(),/^DIV$/);if(f&&(this.rte.dom.attr(f,"clear")||a(f).css("clear")!="none")){return f
}}};this.command=function(){var f;if((f=this.find())){var f=a(f);this.rte.history.add();if(!f.children().length&&!a.trim(f.text()).length){f.remove()}else{f.removeAttr("clear").css("clear","")}}else{this.rte.history.add();this.rte.selection.insertNode(a(this.rte.dom.create("div")).css("clear","both").get(0),true)}this.rte.ui.update(true)};this.update=function(){this.domElem.removeClass("disabled");if(this.find()){this.domElem.addClass("active")}else{this.domElem.removeClass("active")}}}})(jQuery);
(function(a){elRTE.prototype.ui.prototype.buttons.table=function(g,f){this.constructor.prototype.constructor.call(this,g,f);var b=this;this.src=null;this.labels=null;function c(){b.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",summary:"Summary",lang:"Language",href:"URL"};b.src={main:{caption:a('<input type="text" />'),rows:a('<input type="text" />').attr("size",5).val(2),cols:a('<input type="text" />').attr("size",5).val(2),width:a('<input type="text" />').attr("size",5),wunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),height:a('<input type="text" />').attr("size",5),hunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),align:a("<select />").append(a("<option />").val("").text(b.rte.i18n("Not set"))).append(a("<option />").val("left").text(b.rte.i18n("Left"))).append(a("<option />").val("center").text(b.rte.i18n("Center"))).append(a("<option />").val("right").text(b.rte.i18n("Right"))),spacing:a('<input type="text" />').attr("size",5),padding:a('<input type="text" />').attr("size",5),border:a("<div />"),rules:a("<select />").append(a("<option />").val("none").text(b.rte.i18n("No"))).append(a("<option />").val("all").text(b.rte.i18n("Cells"))).append(a("<option />").val("groups").text(b.rte.i18n("Groups"))).append(a("<option />").val("rows").text(b.rte.i18n("Rows"))).append(a("<option />").val("cols").text(b.rte.i18n("Columns"))),margin:a("<div />"),bg:a("<div />"),bgimg:a('<input type="text" />').css("width","90%")},adv:{id:a('<input type="text" />'),summary:a('<input type="text" />'),"class":a('<input type="text" />'),style:a('<input type="text" />'),dir:a("<select />").append(a("<option />").text(b.rte.i18n("Not set")).val("")).append(a("<option />").text(b.rte.i18n("Left to right")).val("ltr")).append(a("<option />").text(b.rte.i18n("Right to left")).val("rtl")),lang:a('<input type="text" />')},events:{}};
a.each(b.src,function(){for(var h in this){this[h].attr("name",h);var j=this[h].get(0).nodeName;if(j=="INPUT"&&h!="bgimg"){this[h].css(this[h].attr("size")?{"text-align":"right"}:{width:"100%"})}else{if(j=="SELECT"&&h!="wunit"&&h!="hunit"){this[h].css("width","100%")}}}});a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />').css("width","100%")
});b.src.main.align.change(function(){var h=a(this).val();if(h=="center"){b.src.main.margin.val({left:"auto",right:"auto"})}else{var j=b.src.main.margin.val();if(j.left=="auto"&&j.right=="auto"){b.src.main.margin.val({left:"",right:""})}}});b.src.main.bgimg.change(function(){var h=a(this);h.val(b.rte.utils.absoluteURL(h.val()))})}this.command=function(){var z=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/);if(this.name=="table"){this.table=a(this.rte.doc.createElement("table"))}else{this.table=z?a(z):a(this.rte.doc.createElement("table"))
}!this.src&&c();this.src.main.border.elBorderSelect({styleHeight:117});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.margin.elPaddingInput({type:"margin",value:this.table});if(this.table.parents().length){this.src.main.rows.val("").attr("disabled",true);this.src.main.cols.val("").attr("disabled",true)}else{this.src.main.rows.val(2).removeAttr("disabled");this.src.main.cols.val(2).removeAttr("disabled")}var x=this.table.css("width")||this.table.attr("width");
this.src.main.width.val(parseInt(x)||"");this.src.main.wunit.val(x.indexOf("px")!=-1?"px":"%");var u=this.table.css("height")||this.table.attr("height");this.src.main.height.val(parseInt(u)||"");this.src.main.hunit.val(u&&u.indexOf("px")!=-1?"px":"%");var E=this.table.css("float");this.src.main.align.val("");if(E=="left"||E=="right"){this.src.main.align.val(E)}else{var D=this.table.css("margin-left");var C=this.table.css("margin-right");if(D=="auto"&&C=="auto"){this.src.main.align.val("center")}}this.src.main.border.val(this.table);
this.src.main.rules.val(this.rte.dom.attr(this.table.get(0),"rules"));this.src.main.bg.val(this.table.css("background-color"));var o=(this.table.css("background-image")||"").replace(/url\(([^\)]+)\)/i,"$1");this.src.main.bgimg.val(o!="none"?o:"");var A={rtl:this.rte.rtl,submit:function(v,h){v.stopPropagation();v.preventDefault();b.set();h.close()},dialog:{width:530,title:this.rte.i18n("Table")}};var B=new elDialogForm(A);for(var q in this.src){B.tab(q,this.rte.i18n(this.labels[q]));if(q=="main"){var k=a("<table />").append(a("<tr />").append("<td>"+this.rte.i18n("Rows")+"</td>").append(a("<td />").append(this.src.main.rows))).append(a("<tr />").append("<td>"+this.rte.i18n("Columns")+"</td>").append(a("<td />").append(this.src.main.cols)));
var t=a("<table />").append(a("<tr />").append("<td>"+this.rte.i18n("Width")+"</td>").append(a("<td />").append(this.src.main.width).append(this.src.main.wunit))).append(a("<tr />").append("<td>"+this.rte.i18n("Height")+"</td>").append(a("<td />").append(this.src.main.height).append(this.src.main.hunit)));var p=a("<table />").append(a("<tr />").append("<td>"+this.rte.i18n("Spacing")+"</td>").append(a("<td />").append(this.src.main.spacing.val(this.table.attr("cellspacing")||"")))).append(a("<tr />").append("<td>"+this.rte.i18n("Padding")+"</td>").append(a("<td />").append(this.src.main.padding.val(this.table.attr("cellpadding")||""))));
B.append([this.rte.i18n("Caption"),this.src.main.caption.val(this.table.find("caption").eq(0).text()||"")],"main",true).separator("main").append([k,t,p],"main",true).separator("main").append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Inner borders"),this.src.main.rules],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Margins"),this.src.main.margin],"main",true).append([this.rte.i18n("Background"),a("<span />").append(a("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true)
}else{for(var j in this.src[q]){var r=this.rte.dom.attr(this.table,j);if(q=="events"){r=this.rte.utils.trimEventCallback(r)}B.append([this.rte.i18n(this.labels[j]?this.labels[j]:j),this.src[q][j].val(r)],q,true)}}}B.open()};this.set=function(){if(!this.table.parents().length){var k=parseInt(this.src.main.rows.val())||0;var G=parseInt(this.src.main.cols.val())||0;if(k<=0||G<=0){return}this.rte.history.add();var H=a(this.rte.doc.createElement("tbody")).appendTo(this.table);for(var t=0;t<k;t++){var q="<tr>";
for(var p=0;p<G;p++){q+="<td>&nbsp;</td>"}H.append(q+"</tr>")}}else{this.table.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor").removeAttr("cellspacing").removeAttr("cellpadding").removeAttr("frame").removeAttr("rules").removeAttr("style")}var F=a.trim(this.src.main.caption.val());if(F){if(!this.table.children("caption").length){this.table.prepend("<caption />")}this.table.children("caption").text(F)}else{this.table.children("caption").remove()
}for(var o in this.src){if(o!="main"){for(var B in this.src[o]){var u=a.trim(this.src[o][B].val());if(u){this.table.attr(B,u)}else{this.table.removeAttr(B)}}}}var E,D,C;if((E=parseInt(this.src.main.spacing.val()))&&E>=0){this.table.attr("cellspacing",E)}if((D=parseInt(this.src.main.padding.val()))&&D>=0){this.table.attr("cellpadding",D)}if((C=this.src.main.rules.val())){this.table.attr("rules",C)}var z=parseInt(this.src.main.width.val())||"",x=parseInt(this.src.main.height.val())||"",t=a.trim(this.src.main.bgimg.val()),H=this.src.main.border.val(),A=this.src.main.margin.val(),I=this.src.main.align.val();
this.table.css({width:z?z+this.src.main.wunit.val():"",height:x?x+this.src.main.hunit.val():"",border:a.trim(H.width+" "+H.style+" "+H.color),"background-color":this.src.main.bg.val(),"background-image":t?"url("+t+")":""});if(A.css){this.table.css("margin",A.css)}else{this.table.css({"margin-top":A.top,"margin-right":A.right,"margin-bottom":A.bottom,"margin-left":A.left})}if((I=="left"||I=="right")&&this.table.css("margin-left")!="auto"&&this.table.css("margin-right")!="auto"){this.table.css("float",I)
}if(!this.table.attr("style")){this.table.removeAttr("style")}if(!this.table.parents().length){this.rte.selection.insertNode(this.table.get(0),true)}this.rte.ui.update()};this.update=function(){this.domElem.removeClass("disabled");if(this.name=="tableprops"&&!this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.addClass("disabled").removeClass("active")}}};elRTE.prototype.ui.prototype.buttons.tableprops=elRTE.prototype.ui.prototype.buttons.table})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tablerm=function(c,b){this.constructor.prototype.constructor.call(this,c,b);
this.command=function(){var f=this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/);if(f){this.rte.history.add();a(f).remove()}this.rte.ui.update(true)};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcellprops=function(g,f){this.constructor.prototype.constructor.call(this,g,f);var b=this;this.src=null;this.labels=null;
function c(){b.labels={main:"Properies",adv:"Advanced",events:"Events",id:"ID","class":"Css class",style:"Css style",dir:"Script direction",lang:"Language"};b.src={main:{type:a("<select />").css("width","100%").append(a("<option />").val("td").text(b.rte.i18n("Data"))).append(a("<option />").val("th").text(b.rte.i18n("Header"))),width:a('<input type="text" />').attr("size",4),wunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),height:a('<input type="text" />').attr("size",4),hunit:a("<select />").append(a("<option />").val("%").text("%")).append(a("<option />").val("px").text("px")),align:a("<select />").css("width","100%").append(a("<option />").val("").text(b.rte.i18n("Not set"))).append(a("<option />").val("left").text(b.rte.i18n("Left"))).append(a("<option />").val("center").text(b.rte.i18n("Center"))).append(a("<option />").val("right").text(b.rte.i18n("Right"))).append(a("<option />").val("justify").text(b.rte.i18n("Justify"))),border:a("<div />"),padding:a("<div />"),bg:a("<div />"),bgimg:a('<input type="text" />').css("width","90%"),apply:a("<select />").css("width","100%").append(a("<option />").val("").text(b.rte.i18n("Current cell"))).append(a("<option />").val("row").text(b.rte.i18n("All cells in row"))).append(a("<option />").val("column").text(b.rte.i18n("All cells in column"))).append(a("<option />").val("table").text(b.rte.i18n("All cells in table")))},adv:{id:a('<input type="text" />'),"class":a('<input type="text" />'),style:a('<input type="text" />'),dir:a("<select />").css("width","100%").append(a("<option />").text(b.rte.i18n("Not set")).val("")).append(a("<option />").text(b.rte.i18n("Left to right")).val("ltr")).append(a("<option />").text(b.rte.i18n("Right to left")).val("rtl")),lang:a('<input type="text" />')},events:{}};
a.each(b.src,function(){for(var h in this){this[h].attr("name",h);if(this[h].attr("type")=="text"&&!this[h].attr("size")&&h!="bgimg"){this[h].css("width","100%")}}});a.each(["onblur","onfocus","onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmouseout","onmouseleave","onkeydown","onkeypress","onkeyup"],function(){b.src.events[this]=a('<input type="text" />').css("width","100%")})}this.command=function(){!this.src&&c();this.cell=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);
if(!this.cell){return}this.src.main.type.val(this.cell.nodeName.toLowerCase());this.cell=a(this.cell);this.src.main.border.elBorderSelect({styleHeight:117,value:this.cell});this.src.main.bg.elColorPicker({palettePosition:"outer","class":"el-colorpicker ui-icon ui-icon-pencil"});this.src.main.padding.elPaddingInput({value:this.cell});var q=this.cell.css("width")||this.cell.attr("width");this.src.main.width.val(parseInt(q)||"");this.src.main.wunit.val(q.indexOf("px")!=-1?"px":"%");var u=this.cell.css("height")||this.cell.attr("height");
this.src.main.height.val(parseInt(u)||"");this.src.main.hunit.val(u.indexOf("px")!=-1?"px":"%");this.src.main.align.val(this.cell.attr("align")||this.cell.css("text-align"));this.src.main.bg.val(this.cell.css("background-color"));var o=this.cell.css("background-image");this.src.main.bgimg.val(o&&o!="none"?o.replace(/url\(([^\)]+)\)/i,"$1"):"");this.src.main.apply.val("");var t={rtl:this.rte.rtl,submit:function(v,h){v.stopPropagation();v.preventDefault();b.set();h.close()},dialog:{width:520,title:this.rte.i18n("Table cell properties")}};
var k=new elDialogForm(t);for(var p in this.src){k.tab(p,this.rte.i18n(this.labels[p]));if(p=="main"){k.append([this.rte.i18n("Width"),a("<span />").append(this.src.main.width).append(this.src.main.wunit)],"main",true).append([this.rte.i18n("Height"),a("<span />").append(this.src.main.height).append(this.src.main.hunit)],"main",true).append([this.rte.i18n("Table cell type"),this.src.main.type],"main",true).append([this.rte.i18n("Border"),this.src.main.border],"main",true).append([this.rte.i18n("Alignment"),this.src.main.align],"main",true).append([this.rte.i18n("Paddings"),this.src.main.padding],"main",true).append([this.rte.i18n("Background"),a("<span />").append(a("<span />").css({"float":"left","margin-right":"3px"}).append(this.src.main.bg)).append(this.src.main.bgimg)],"main",true).append([this.rte.i18n("Apply to"),this.src.main.apply],"main",true)
}else{for(var r in this.src[p]){var j=this.cell.attr(r)||"";if(p=="events"){j=this.rte.utils.trimEventCallback(j)}k.append([this.rte.i18n(this.labels[r]?this.labels[r]:r),this.src[p][r].val(j)],p,true)}}}k.open()};this.set=function(){var D=this.cell,B=this.src.main.apply.val();switch(this.src.main.apply.val()){case"row":D=this.cell.parent("tr").children("td,th");break;case"column":D=a(this.rte.dom.tableColumn(this.cell.get(0)));break;case"table":D=this.cell.parents("table").find("td,th");break}for(var q in this.src){if(q!="main"){for(var A in this.src[q]){var u=a.trim(this.src[q][A].val());
if(u){D.attr(A,u)}else{D.removeAttr(A)}}}}D.removeAttr("width").removeAttr("height").removeAttr("border").removeAttr("align").removeAttr("bordercolor").removeAttr("bgcolor");var k=this.src.main.type.val();var z=parseInt(this.src.main.width.val())||"";var x=parseInt(this.src.main.height.val())||"";var r=a.trim(this.src.main.bgimg.val());var C=this.src.main.border.val();var o={width:z?z+this.src.main.wunit.val():"",height:x?x+this.src.main.hunit.val():"","background-color":this.src.main.bg.val(),"background-image":r?"url("+r+")":"",border:a.trim(C.width+" "+C.style+" "+C.color),"text-align":this.src.main.align.val()||""};
var j=this.src.main.padding.val();if(j.css){o.padding=j.css}else{o["padding-top"]=j.top;o["padding-right"]=j.right;o["padding-bottom"]=j.bottom;o["padding-left"]=j.left}D=D.get();a.each(D,function(){var t=this.nodeName.toLowerCase();var F=a(this);if(t!=k){var p={};for(var E in b.src.adv){var h=F.attr(E);if(h){p[E]=h.toString()}}for(var E in b.src.events){var h=F.attr(E);if(h){p[E]=h.toString()}}var G=F.attr("colspan")||1;var w=F.attr("rowspan")||1;if(G>1){p.colspan=G}if(w>1){p.rowspan=w}F.replaceWith(a("<"+k+" />").html(F.html()).attr(p).css(o))
}else{F.css(o)}});this.rte.ui.update()};this.update=function(){if(this.rte.dom.parent(this.rte.selection.getNode(),/^TABLE$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcellsmerge=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;function g(){var h=b.rte.dom.selfOrParent(b.rte.selection.getStart(),/^(TD|TH)$/);var j=b.rte.dom.selfOrParent(b.rte.selection.getEnd(),/^(TD|TH)$/);
if(h&&j&&h!=j&&a(h).parents("table").get(0)==a(j).parents("table").get(0)){return[h,j]}return null}this.command=function(){var p=g();if(p){var k=this.rte.dom.indexOf(a(p[0]).parent("tr").get(0));var A=this.rte.dom.indexOf(a(p[1]).parent("tr").get(0));var t=Math.min(k,A);var v=Math.max(k,A)-t+1;var z=this.rte.dom.tableColumn(p[0],true,true);var r=this.rte.dom.tableColumn(p[1],true);var h=a.inArray(p[0],z.column);var u=a.inArray(p[1],r.column);var x=z.info.offset[h]<r.info.offset[u]?z:r;var w=z.info.offset[h]>=r.info.offset[u]?z:r;
var q=0;var B=null;var j="";this.rte.history.add();var o=a(a(p[0]).parents("table").eq(0).find("tr").get().slice(t,t+v)).each(function(D){var E=j.length;var C=false;a(this).children("td,th").each(function(){var I=a(this);var L=a.inArray(this,x.column);var F=a.inArray(this,w.column);if(L!=-1||F!=-1){C=L!=-1&&F==-1;var J=parseInt(I.attr("colspan")||1);if(D==0){q+=J}if(L!=-1&&D>0){var K=x.info.delta[L];if(K>0){if(I.css("text-align")=="left"){var H=I.clone(true);I.html("&nbsp;")}else{var H=I.clone().html("&nbsp;")
}H.removeAttr("colspan").removeAttr("id").insertBefore(this);if(K>1){H.attr("colspan",K)}}}if(F!=-1){var K=w.info.delta[F];if(J-K>1){var G=J-K-1;if(I.css("text-align")=="right"){var H=I.clone(true);I.html("&nbsp;")}else{var H=I.clone().html("&nbsp;")}H.removeAttr("colspan").removeAttr("id").insertAfter(this);if(G>1){H.attr("colspan",G)}}}if(!B){B=I}else{j+=I.html();I.remove()}}else{if(C){if(D==0){q+=parseInt(I.attr("colspan")||1)}j+=I.html();I.remove()}}});j+=E!=j.length?"<br />":""});B.removeAttr("colspan").removeAttr("rowspan").html(B.html()+j);
if(q>1){B.attr("colspan",q)}if(v>1){B.attr("rowspan",v)}this.rte.dom.fixTable(a(p[0]).parents("table").get(0))}};this.update=function(){if(g()){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcellsplit=function(c,b){this.constructor.prototype.constructor.call(this,c,b);this.command=function(){var q=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(q){this.rte.history.add();var x=parseInt(this.rte.dom.attr(q,"colspan"));
var u=parseInt(this.rte.dom.attr(q,"rowspan"));if(x>1||u>1){var j=x-1;var t=u-1;var h=this.rte.dom.parent(q,/^TABLE$/);var o=this.rte.dom.tableMatrix(h);if(j){for(var p=0;p<j;p++){a(this.rte.dom.create(q.nodeName)).html("&nbsp;").insertAfter(q)}}if(t){var g=this.rte.dom.indexesOfCell(q,o);var w=g[0];var f=g[1];for(var k=w+1;k<w+t+1;k++){var v;if(!o[k][f].nodeName){if(o[k][f-1].nodeName){v=o[k][f-1]}else{for(var p=f-1;p>=0;p--){if(o[k][p].nodeName){v=o[k][p];break}}}if(v){for(var p=0;p<=j;p++){a(this.rte.dom.create(v.nodeName)).html("&nbsp;").insertAfter(v)
}}}}}a(q).removeAttr("colspan").removeAttr("rowspan");this.rte.dom.fixTable(h)}}this.rte.ui.update(true)};this.update=function(){var f=this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/);if(f&&(parseInt(this.rte.dom.attr(f,"colspan"))>1||parseInt(this.rte.dom.attr(f,"rowspan"))>1)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcolbefore=function(f,c){this.constructor.prototype.constructor.call(this,f,c);
var b=this;this.command=function(){var h=this;var g=this.rte.dom.tableColumn(this.rte.selection.getNode(),false,true);if(g.length){this.rte.history.add();a.each(g,function(){var k=a(this);var j=parseInt(k.attr("colspan")||1);if(j>1){k.attr("colspan",j+1)}else{var o=a(h.rte.dom.create(this.nodeName)).html("&nbsp;");if(h.name=="tbcolbefore"){o.insertBefore(this)}else{o.insertAfter(this)}}});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")
}else{this.domElem.addClass("disabled")}}};elRTE.prototype.ui.prototype.buttons.tbcolafter=elRTE.prototype.ui.prototype.buttons.tbcolbefore})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.tbcolrm=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.command=function(){var g=this.rte.selection.getNode();var p=this.rte.dom.selfOrParent(g,/^(TD|TH)$/);var o=a(p).prev("td,th").get(0);var k=a(p).next("td,th").get(0);var j=this.rte.dom.parent(g,/^TABLE$/);var h=this.rte.dom.tableColumn(g,false,true);
if(h.length){this.rte.history.add();a.each(h,function(){var r=a(this);var q=parseInt(r.attr("colspan")||1);if(q>1){r.attr("colspan",q-1)}else{r.remove()}});this.rte.dom.fixTable(j);if(o||k){this.rte.selection.selectContents(o?o:k).collapse(true)}this.rte.ui.update(true)}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^(TD|TH)$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);elRTE.prototype.ui.prototype.buttons.tbrowbefore=function(b,a){this.constructor.prototype.constructor.call(this,b,a);
this.command=function(){var p=this.rte.selection.getNode();var x=this.rte.dom.selfOrParent(p,/^(TD|TH)$/);var h=this.rte.dom.selfOrParent(x,/^TR$/);var o=this.rte.dom.tableMatrix(this.rte.dom.selfOrParent(x,/^TABLE$/));if(x&&h&&o){this.rte.history.add();var f=this.name=="tbrowbefore";var q=$(h).prevAll("tr").length;var k=0;var u=[];function g(r,c){while(c>0){c--;if(o[c]&&o[c][r]&&o[c][r].nodeName){return o[c][r]}}}for(var j=0;j<o[q].length;j++){if(o[q][j]&&o[q][j].nodeName){var t=$(o[q][j]);var w=parseInt(t.attr("colspan")||1);
if(parseInt(t.attr("rowspan")||1)>1){if(f){k+=w}else{u.push(t)}}else{k+=w}}else{if(o[q][j]=="-"){t=g(j,q);t&&u.push($(t))}}}var v=$(this.rte.dom.create("tr"));for(var j=0;j<k;j++){v.append("<td>&nbsp;</td>")}if(f){v.insertBefore(h)}else{v.insertAfter(h)}$.each(u,function(){$(this).attr("rowspan",parseInt($(this).attr("rowspan")||1)+1)});this.rte.ui.update()}};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")
}}};elRTE.prototype.ui.prototype.buttons.tbrowafter=elRTE.prototype.ui.prototype.buttons.tbrowbefore;(function(a){elRTE.prototype.ui.prototype.buttons.tbrowrm=function(f,c){this.constructor.prototype.constructor.call(this,f,c);var b=this;this.command=function(){var u=this.rte.selection.getNode(),B=this.rte.dom.selfOrParent(u,/^(TD|TH)$/),j=this.rte.dom.selfOrParent(B,/^TR$/),g=this.rte.dom.selfOrParent(B,/^TABLE$/),t=this.rte.dom.tableMatrix(g);if(B&&j&&t.length){this.rte.history.add();if(t.length==1){a(g).remove();
return this.rte.ui.update()}var z=[];var v=a(j).prevAll("tr").length;function k(C,r){while(r>0){r--;if(t[r]&&t[r][C]&&t[r][C].nodeName){return t[r][C]}}}function h(r,E){y=v+1;var D=null;if(t[y]){for(var C=0;C<E;C++){if(t[y][C]&&t[y][C].nodeName){D=t[y][C]}}r=r.remove();if(D){r.insertAfter(D)}else{r.prependTo(a(j).next("tr").eq(0))}}}function q(C){for(var r=0;r<C.length;r++){if(C[r]==B){return r<C.length-1?C[r+1]:C[r-1]}}}for(var p=0;p<t[v].length;p++){var x=null;var A=false;if(t[v][p]&&t[v][p].nodeName){x=t[v][p];
A=true}else{if(t[v][p]=="-"&&(x=k(p,v))){A=false}}if(x){x=a(x);var w=parseInt(x.attr("rowspan")||1);if(w>1){x.attr("rowspan",w-1);A&&h(x,p,v)}}}var o=q(this.rte.dom.tableColumn(B));if(o){this.rte.selection.selectContents(o).collapse(true)}a(j).remove()}this.rte.ui.update()};this.update=function(){if(this.rte.dom.selfOrParent(this.rte.selection.getNode(),/^TR$/)){this.domElem.removeClass("disabled")}else{this.domElem.addClass("disabled")}}}})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.undo=function(c,b){this.constructor.prototype.constructor.call(this,c,b);
this.command=function(){if(this.name=="undo"&&this.rte.history.canBack()){this.rte.history.back();this.rte.ui.update()}else{if(this.name=="redo"&&this.rte.history.canFwd()){this.rte.history.fwd();this.rte.ui.update()}}};this.update=function(){this.domElem.toggleClass("disabled",this.name=="undo"?!this.rte.history.canBack():!this.rte.history.canFwd())}};elRTE.prototype.ui.prototype.buttons.redo=elRTE.prototype.ui.prototype.buttons.undo})(jQuery);(function(a){elRTE.prototype.ui.prototype.buttons.unlink=function(c,b){this.constructor.prototype.constructor.call(this,c,b);
this.command=function(){var g=this.rte.selection.getNode(),f=this.rte.dom.selfOrParentLink(g);function j(o){return o.nodeName=="A"&&o.href}if(!f){var k=a.browser.msie?this.rte.selection.selected():this.rte.selection.selected({wrap:false});if(k.length){for(var h=0;h<k.length;h++){if(j(k[h])){f=k[h];break}}if(!f){f=this.rte.dom.parent(k[0],j)||this.rte.dom.parent(k[k.length-1],j)}}}if(f){this.rte.history.add();this.rte.selection.select(f);this.rte.doc.execCommand("unlink",false,null);this.rte.ui.update(true)
}};this.update=function(){var f=this.rte.selection.getNode();if(this.rte.dom.selfOrParentLink(f)){this.domElem.removeClass("disabled").addClass("active")}else{if(this.rte.dom.selectionHas(function(g){return g.nodeName=="A"&&g.href})){this.domElem.removeClass("disabled").addClass("active")}else{this.domElem.addClass("disabled").removeClass("active")}}}}})(jQuery);